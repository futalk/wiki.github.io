<html><head><meta charset="utf-8" /><style>.pydocx-caps {text-transform:uppercase}.pydocx-center {text-align:center}.pydocx-comment {color:blue}.pydocx-delete {color:red;text-decoration:line-through}.pydocx-hidden {visibility:hidden}.pydocx-insert {color:green}.pydocx-left {text-align:left}.pydocx-list-style-type-cardinalText {list-style-type:decimal}.pydocx-list-style-type-decimal {list-style-type:decimal}.pydocx-list-style-type-decimalEnclosedCircle {list-style-type:decimal}.pydocx-list-style-type-decimalEnclosedFullstop {list-style-type:decimal}.pydocx-list-style-type-decimalEnclosedParen {list-style-type:decimal}.pydocx-list-style-type-decimalZero {list-style-type:decimal-leading-zero}.pydocx-list-style-type-lowerLetter {list-style-type:lower-alpha}.pydocx-list-style-type-lowerRoman {list-style-type:lower-roman}.pydocx-list-style-type-none {list-style-type:none}.pydocx-list-style-type-ordinalText {list-style-type:decimal}.pydocx-list-style-type-upperLetter {list-style-type:upper-alpha}.pydocx-list-style-type-upperRoman {list-style-type:upper-roman}.pydocx-right {text-align:right}.pydocx-small-caps {font-variant:small-caps}.pydocx-strike {text-decoration:line-through}.pydocx-tab {display:inline-block;width:4em}.pydocx-underline {text-decoration:underline}body {margin:0px auto}</style></head><body><h1>YouDianCMS 8.0 sql注入漏洞</h1><h2>一、漏洞简介</h2><h2>二、漏洞影响</h2><p>YouDianCMS 8.0</p><h2>三、复现过程</h2><h3>漏洞分析</h3><p>需要先登录此漏洞。页面可以注册。</p><p><a href="http://localhost/youdiancms/index.php/public/reg/l/cn">http://localhost/youdiancms/index.php/public/reg/l/cn</a></p><p>在这里登录</p><p>漏洞位置位于index.php/member/customer/index搜索栏</p><p>未筛选搜索的关键字，导致sql注入漏洞</p><p>/App/Lib/Action/Member/CustomerAction.class.php：</p><p>function saveModify(){<br />    header("Content-Type:text/html; charset=utf-8");<br />    $this-&gt;_checkPost( $_POST );<br />    unset( $_POST['InviterID'], $_POST['IsEnable']);<br />    $m = D('Admin/Member');<br />    $inviterID = $m-&gt;where(&quot;MemberID={$_POST['MemberID']}&quot;)-&gt;getField('InviterID');<br />    //检查当前MemberID是否自己的客户<br />    if( $inviterID == session('MemberID')){<br />        if( $m-&gt;create() ){<br />            if($m-&gt;save() === false){<br />                $this-&gt;ajaxReturn(null, '修改失败!' , 0);<br />            }else{<br />                $this-&gt;ajaxReturn(null, '修改成功!' , 1);<br />            }<br />        }else{<br />            $this-&gt;ajaxReturn(null, $m-&gt;getError() , 0);<br />        }<br />    }else{<br />        $this-&gt;ajaxReturn(null, '数据异常' , 0);<br />    }<br />}</p><p>漏洞点在:</p><p>    $inviterID = $m-&gt;where(&quot;MemberID={$_POST['MemberID']}&quot;)-&gt;getField('InviterID');</p><p>上述代码直接将POST带入进了where子查询。</p><h3>复现</h3><p>POC：</p><p>URL：http://www.0-sec.org/index.php/Member/Customer/saveModify<br />POST：MemberName=xxxxx&amp;MemberID=[SQL]</p><h2>四、参考链接</h2><p><a href="https://blog.csdn.net/qq_36093477/article/details/98035255">https://blog.csdn.net/qq_36093477/article/details/98035255</a></p><p><a href="http://www.f4ckweb.top/index.php/archives/45/">http://www.f4ckweb.top/index.php/archives/45/</a></p></body></html>