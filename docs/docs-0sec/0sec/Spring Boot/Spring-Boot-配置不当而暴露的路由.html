<html><head><meta charset="utf-8" /><style>.pydocx-caps {text-transform:uppercase}.pydocx-center {text-align:center}.pydocx-comment {color:blue}.pydocx-delete {color:red;text-decoration:line-through}.pydocx-hidden {visibility:hidden}.pydocx-insert {color:green}.pydocx-left {text-align:left}.pydocx-list-style-type-cardinalText {list-style-type:decimal}.pydocx-list-style-type-decimal {list-style-type:decimal}.pydocx-list-style-type-decimalEnclosedCircle {list-style-type:decimal}.pydocx-list-style-type-decimalEnclosedFullstop {list-style-type:decimal}.pydocx-list-style-type-decimalEnclosedParen {list-style-type:decimal}.pydocx-list-style-type-decimalZero {list-style-type:decimal-leading-zero}.pydocx-list-style-type-lowerLetter {list-style-type:lower-alpha}.pydocx-list-style-type-lowerRoman {list-style-type:lower-roman}.pydocx-list-style-type-none {list-style-type:none}.pydocx-list-style-type-ordinalText {list-style-type:decimal}.pydocx-list-style-type-upperLetter {list-style-type:upper-alpha}.pydocx-list-style-type-upperRoman {list-style-type:upper-roman}.pydocx-right {text-align:right}.pydocx-small-caps {font-variant:small-caps}.pydocx-strike {text-decoration:line-through}.pydocx-tab {display:inline-block;width:4em}.pydocx-underline {text-decoration:underline}body {margin:0px auto}</style></head><body><h1>Spring Boot 配置不当而暴露的路由</h1><h2>一、漏洞简介</h2><p>主要是因为程序员开发时没有意识到暴露路由可能会造成安全风险，或者没有按照标准流程开发，忘记上线时需要修改/切换生产环境的配置</p><h2>二、漏洞影响</h2><h2>三、复现过程</h2><h3>路由知识</h3><ul><li>Spring Boot 1.x 版本默认内置路由的根路径以 / 开始，2.x 则统一以 /actuator 开始</li><li>有些程序员会自定义 /manage、/management 或 <strong>项目相关名称</strong> 为根路径</li><li>默认内置路由名字，如 /env 有时候也会被程序员修改，如修改成 /appenv<br />trace<br />health<br />loggers<br />metrics<br />autoconfig<br />heapdump<br />threaddump<br />env<br />info<br />dump<br />configprops<br />mappings<br />auditevents<br />beans<br />jolokia<br />cloudfoundryapplication<br />hystrix.stream<br />actuator<br />actuator/auditevents<br />actuator/beans<br />actuator/health<br />actuator/conditions<br />actuator/configprops<br />actuator/env<br />actuator/info<br />actuator/loggers<br />actuator/heapdump<br />actuator/threaddump<br />actuator/metrics<br />actuator/scheduledtasks<br />actuator/httptrace<br />actuator/mappings<br />actuator/jolokia<br />actuator/hystrix.stream<br />其中对寻找漏洞比较重要接口的有：</li><li>/env、/actuator/env</li></ul><ul><li>GET 请求 /env 会泄露环境变量信息，或者配置中的一些用户名，当程序员的属性名命名不规范 (例如 password 写成 psasword、pwd) 时，会泄露密码明文；</li><li>同时有一定概率可以通过 POST 请求 /env 接口设置一些属性，触发相关 RCE 漏洞。</li></ul><ul><li>/jolokia</li></ul><ul><li>通过 /jolokia/list 接口寻找可以利用的 MBean，触发相关 RCE 漏洞；</li></ul><ul><li>/trace</li></ul><ul><li>一些 http 请求包访问跟踪信息，有可能发现有效的 cookie 信息</li></ul></body></html>