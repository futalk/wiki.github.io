<html><head><meta charset="utf-8" /><style>.pydocx-caps {text-transform:uppercase}.pydocx-center {text-align:center}.pydocx-comment {color:blue}.pydocx-delete {color:red;text-decoration:line-through}.pydocx-hidden {visibility:hidden}.pydocx-insert {color:green}.pydocx-left {text-align:left}.pydocx-list-style-type-cardinalText {list-style-type:decimal}.pydocx-list-style-type-decimal {list-style-type:decimal}.pydocx-list-style-type-decimalEnclosedCircle {list-style-type:decimal}.pydocx-list-style-type-decimalEnclosedFullstop {list-style-type:decimal}.pydocx-list-style-type-decimalEnclosedParen {list-style-type:decimal}.pydocx-list-style-type-decimalZero {list-style-type:decimal-leading-zero}.pydocx-list-style-type-lowerLetter {list-style-type:lower-alpha}.pydocx-list-style-type-lowerRoman {list-style-type:lower-roman}.pydocx-list-style-type-none {list-style-type:none}.pydocx-list-style-type-ordinalText {list-style-type:decimal}.pydocx-list-style-type-upperLetter {list-style-type:upper-alpha}.pydocx-list-style-type-upperRoman {list-style-type:upper-roman}.pydocx-right {text-align:right}.pydocx-small-caps {font-variant:small-caps}.pydocx-strike {text-decoration:line-through}.pydocx-tab {display:inline-block;width:4em}.pydocx-underline {text-decoration:underline}body {margin:0px auto}</style></head><body><h1>Discuz! X3.1 后台任意代码执行漏洞</h1><h2>一、漏洞简介</h2><h2>二、漏洞影响</h2><p>Discuz! X3.1</p><h2>三、复现过程</h2><ul><li>全局--〉网站第三方统计代码--〉插入php代码[其他地方&lt;&gt;会被转意]：<br />如插入 <br />007uCUf6ly1fxlneom4cfj30om0l40vg.jpg</li><li>工具--〉更新缓存[为了保险起见，更新下系统缓存]：<br />2.jpg</li><li>门户--&gt; HTML管理--〉设置：<br />1） 静态文件扩展名[一定要设置成htm] ：htm<br />2) 专题HTML存放目录: template/default/portal<br />3) 设置完，提交吧！<br />3.jpg</li><li>门户--〉专题管理--〉创建专题：<br />1）专题标题：xyz // 这个随便你写了<br />2）静态化名称：portal_topic_222 //222为自定义文件名，自己要记住<br />3）附加内容：选择上： 站点尾部信息<br />4.jpg</li><li>提交</li><li>回到门户--〉专题管理,把刚才创建的专题开启，如下图 ：<br />5.jpg</li><li>把刚才的专题，生成<br />6.jpg<br />下面就是关键了，现在到了包含文件的时候了。</li><li>再新建一个专题：<br />1）专题标题，静态化名称，这2个随便写<br />2）模板名：这个要选择我们刚才生成的页面：./template/default/portal/portal_topic_222.htm<br />7.jpg</li><li>然后提交，就执行了</li></ul><p>8.jpg</p></body></html>